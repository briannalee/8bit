(()=>{"use strict";var t={765:(t,i,e)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BinaryNumber=void 0;var n=e(399),s=function(){function t(t,i,e){this.env=t,this.row=i,this.decimalValue=null!=e?e:0,this.binaryValue=this.decimalValue.toString(2);var n=2*Math.round(this.binaryValue.length/2);this.bits=n>this.env.columns?n:this.env.columns,this.VisualBits=new Array(this.bits),this.createVisualBits(),this.setDecimal(this.decimalValue)}return t.prototype.setCircleValues=function(){var t=!1,i=this.binaryValue;this.VisualBits.length<i.length&&(i=i.substring(i.length-this.VisualBits.length),i=this.setCharAt(i,0,"1"),t=!0);for(var e=this.VisualBits.length-1;e>=0;e--)this.VisualBits[e].setOverflow(t),this.VisualBits[e].setBit("1"==i.charAt(e))},t.prototype.createVisualBits=function(){for(var t=this.bits-1;t>=0;t--)this.VisualBits[t]=this.addVisualBit(t)},t.prototype.addVisualBit=function(t){return new n.VisualBit(this.env.startX+t*this.env.spacing,this.env.startY+this.env.radius+this.env.spacing*this.row,this.env.radius,this.env)},t.prototype.getDecimal=function(){return this.decimalValue},t.prototype.getBinary=function(){return this.binaryValue},t.prototype.setBit=function(t,i){i=null!=i?i:!this.VisualBits[t].set,this.binaryValue=this.setCharAt(this.binaryValue,t,i?"1":"0"),this.VisualBits[t].setBit(i),this.decimalValue=parseInt(this.binaryValue,2)},t.prototype.updateBinaryString=function(){this.binaryValue=this.decimalValue.toString(2),this.binaryValue.length<this.env.columns&&(this.binaryValue=this.binaryValue.padStart(this.env.columns,"0"))},t.prototype.setDecimal=function(t){this.decimalValue=t,this.updateBinaryString(),this.setCircleValues()},t.prototype.setCharAt=function(t,i,e){return i>t.length-1?t:t.substring(0,i)+e+t.substring(i+1)},t}();i.BinaryNumber=s},438:(t,i,e)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasStage=void 0;var n=e(607),s=e(251),r=function(){function t(t){var i,e;if(this.environment=t,document.body.style.backgroundColor="black",!(this.canvas=document.createElement("canvas")))throw new Error("Unable to create canvas");if(this.canvas.id="viewport",!(e=document.getElementById("container")))throw new Error("Unable to append canvas to container");if(e.append(this.canvas),!(this.context=this.canvas.getContext("2d")))throw new Error("2d context not supported or canvas already initialized");var r=this;this.canvas.addEventListener("mouseup",(function(t){r.mouseClickEvent(t)})),null===(i=document.getElementById("compute"))||void 0===i||i.addEventListener("click",(function(t){(0,s.Compute)(r.environment)}));var a=document.getElementById("bits");a&&a.addEventListener("input",(function(t){var i;(i=parseInt(a.value))&&(0,n.ChangeBitSize)(i)})),this.canvas.width=t.width,this.canvas.height=t.height,this.drawLine()}return t.prototype.getMousePosition=function(t){var i=this.canvas.getBoundingClientRect(),e=this.canvas.width/i.width,n=this.canvas.height/i.height;return{x:(t.clientX-i.left)*e,y:(t.clientY-i.top)*n}},t.prototype.mouseClickEvent=function(t){for(var i=this.getMousePosition(t),e=0;e<this.environment.rows;e++){var n=this.environment.spacing,s=this.environment.startY,r=this.environment.startX,a=this.environment.radius;if(i.y>s+e*n&&i.y<s+e*n+n)for(var o=0;o<this.environment.columns;o++)i.x>r+(o*n-a)&&i.x<r+(o*n+a)&&this.environment.BinaryNumbers[e].setBit(o)}},t.prototype.drawLine=function(){this.context.beginPath();var t=this.environment.startY+this.environment.spacing/4+this.environment.rows*this.environment.spacing,i=this.environment.startX-this.environment.radius;this.context.moveTo(i,t),this.context.lineTo(i+this.environment.columns*this.environment.spacing,t),this.context.strokeStyle="white",this.context.stroke(),this.context.closePath()},t.prototype.drawButtons=function(){},t}();i.CanvasStage=r},115:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.debounce=void 0,i.debounce=function(t,i){var e=void 0;return function(){for(var n=[],s=0;s<arguments.length;s++)n[s]=arguments[s];return e||((e={}).promise=new Promise((function(t,i){e.resolve=t,e.reject=i}))),clearTimeout(e.timeout),e.latestArgs=n,e.timeout=setTimeout((function(){var i=e;e=void 0;try{i.resolve(t.apply(void 0,i.latestArgs))}catch(t){i.reject(t)}}),i),e.promise}}},116:(t,i,e)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Environment=void 0;var n=e(438),s=e(765);i.Environment=function(t,i){this.pagePadding=10,this.minWidth=10,this.columns=t,this.rows=i,this.width=Math.min(window.innerWidth,document.documentElement.clientWidth)-2*this.pagePadding,this.height=Math.min(window.innerHeight,document.documentElement.clientHeight)-2*this.pagePadding,this.MaxBits=Math.floor(this.width/(2*this.minWidth+5)),this.columns=Math.max(Math.min(this.MaxBits,this.columns),2),document.getElementById("bits").value=this.columns.toString(),this.radius=Math.max(this.minWidth,Math.floor(Math.min((this.width-5*this.columns)/2/this.columns,(this.height-5*(this.rows+2))/2/(this.rows+2)))),this.spacing=2*this.radius+5;var e=this.columns*this.spacing-10,r=(this.width-e)/2+this.radius,a=(this.rows+2)*this.spacing-10,o=(this.height-a)/2;this.startX=r,this.startY=o,this.circles=new Array(this.rows),this.BinaryNumbers=new Array(this.rows),this.canvas=new n.CanvasStage(this),this.results=new s.BinaryNumber(this,this.rows+1);for(var h=0;h<this.rows;h++)this.BinaryNumbers[h]=new s.BinaryNumber(this,h)}},251:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Compute=void 0,i.Compute=function(t){for(var i=0,e=0;e<t.rows;e++)i+=t.BinaryNumbers[e].getDecimal();t.results.setDecimal(i)}},399:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.VisualBit=void 0;var e=function(){function t(t,i,e,n,s){this.x=t,this.y=i,this.set=null!=s&&s,this.radius=e,this.left=this.x-e-1,this.top=this.y-e-1,this.right=this.x+e+1,this.bottom=this.y+e+1,this.env=n,this.fillColor="white",this.draw()}return t.prototype.switchBit=function(){this.set=!this.set,this.draw()},t.prototype.setBit=function(t){this.set=t,this.draw()},t.prototype.setOverflow=function(t){this.fillColor=t?"red":"white"},t.prototype.draw=function(){var t=this.env.canvas.context;t.clearRect(this.left,this.top,2*this.radius+2,2*this.radius+2),t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fillStyle=this.set?this.fillColor:"#0f0f0f",t.strokeStyle=this.set?"#95c299":"#330400",t.fill(),t.stroke(),t.closePath()},t}();i.VisualBit=e},607:(t,i,e)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ChangeBitSize=void 0;var n,s=e(115),r=e(116),a=(0,s.debounce)(c,200),o=(0,s.debounce)((function(t){t=Math.min(n.MaxBits,t),t=Math.max(2,t),document.getElementById("bits").value=t.toString(),h=t,c()}),200),h=8,u=2;function l(){n=new r.Environment(h,u)}function c(){if(null!=document.getElementById("viewport")){document.getElementById("viewport").remove();var t=n.BinaryNumbers,i=n.results;l(),n.results.setDecimal(i.getDecimal());for(var e=0;e<t.length;e++){var s=t[e].getBinary();s=s.substring(s.length-h),n.BinaryNumbers[e].setDecimal(parseInt(s,2))}}}l(),window.addEventListener("resize",(function(t){a()})),i.ChangeBitSize=function(t){o(t)}}},i={};!function e(n){var s=i[n];if(void 0!==s)return s.exports;var r=i[n]={exports:{}};return t[n](r,r.exports,e),r.exports}(607)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0ksRUFBT0QsT0FDZixDQ25CMEJILENBQW9CLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly84Yml0Ly4vc3JjL0JpbmFyeU51bWJlci50cyIsIndlYnBhY2s6Ly84Yml0Ly4vc3JjL0NhbnZhc1N0YWdlLnRzIiwid2VicGFjazovLzhiaXQvLi9zcmMvRGVib3VuY2VWYWx1ZS50cyIsIndlYnBhY2s6Ly84Yml0Ly4vc3JjL0Vudmlyb25tZW50LnRzIiwid2VicGFjazovLzhiaXQvLi9zcmMvTWF0aEhlbHBlci50cyIsIndlYnBhY2s6Ly84Yml0Ly4vc3JjL1Zpc3VhbEJpdC50cyIsIndlYnBhY2s6Ly84Yml0Ly4vc3JjL2luZGV4LnRzIiwid2VicGFjazovLzhiaXQvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vOGJpdC93ZWJwYWNrL3N0YXJ0dXAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsga2lsbCB9IGZyb20gXCJwcm9jZXNzXCI7XG5pbXBvcnQgeyBDaGFuZ2VCaXRTaXplIH0gZnJvbSBcIi5cIjtcbmltcG9ydCB7IEVudmlyb25tZW50IH0gZnJvbSBcIi4vRW52aXJvbm1lbnRcIjtcbmltcG9ydCB7IFZpc3VhbEJpdCB9IGZyb20gXCIuL1Zpc3VhbEJpdFwiO1xuXG4vKipcbiAqIE51bWJlciBjbGFzcyByZXByZXNlbnRzIGEgdmFsdWUgKG9uZSBjb2x1bW4pLCBjb250YWluaW5nIHRoZSBkZWNpbWFsICYgYmluYXJ5IHZhbHVlXG4gKiBIb2xkcyB0aGUgYXJyYXkgb2YgY2lyY2xlcyB1c2VkIHRvIHZpc3VhbGx5IHJlcHJlc2VudCB0aGUgYmluYXJ5IHZhbHVlXG4gKi9cbmV4cG9ydCBjbGFzcyBCaW5hcnlOdW1iZXIge1xuICAgIHByaXZhdGUgYml0czogbnVtYmVyO1xuICAgIHByaXZhdGUgZGVjaW1hbFZhbHVlOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBiaW5hcnlWYWx1ZTogc3RyaW5nO1xuICAgIHB1YmxpYyBWaXN1YWxCaXRzOiBWaXN1YWxCaXRbXTtcbiAgICBwcml2YXRlIGVudjogRW52aXJvbm1lbnQ7XG4gICAgcHJpdmF0ZSByb3c6IG51bWJlcjtcblxuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcihlbnY6IEVudmlyb25tZW50LCByb3c6IG51bWJlcik7XG4gICAgcHVibGljIGNvbnN0cnVjdG9yKGVudjogRW52aXJvbm1lbnQsIHJvdzogbnVtYmVyLCBkZWNpbWFsVmFsdWU/OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5lbnYgPSBlbnY7XG4gICAgICAgIHRoaXMucm93ID0gcm93O1xuICAgICAgICB0aGlzLmRlY2ltYWxWYWx1ZSA9IGRlY2ltYWxWYWx1ZSA/PyAwO1xuICAgICAgICB0aGlzLmJpbmFyeVZhbHVlID0gdGhpcy5kZWNpbWFsVmFsdWUudG9TdHJpbmcoMik7XG4gICAgICAgIGNvbnN0IG5ld0JpdHMgPSAyICogTWF0aC5yb3VuZCh0aGlzLmJpbmFyeVZhbHVlLmxlbmd0aCAvIDIpO1xuICAgICAgICB0aGlzLmJpdHMgPSBuZXdCaXRzID4gdGhpcy5lbnYuY29sdW1ucyA/IG5ld0JpdHMgOiB0aGlzLmVudi5jb2x1bW5zO1xuICAgICAgICB0aGlzLlZpc3VhbEJpdHMgPSBuZXcgQXJyYXkodGhpcy5iaXRzKTtcbiAgICAgICAgdGhpcy5jcmVhdGVWaXN1YWxCaXRzKCk7XG4gICAgICAgIHRoaXMuc2V0RGVjaW1hbCh0aGlzLmRlY2ltYWxWYWx1ZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRDaXJjbGVWYWx1ZXMoKSB7XG4gICAgICAgIGxldCBvdmVyZmxvdzogYm9vbGVhbiA9IGZhbHNlO1xuICAgICAgICBsZXQgYmluYXJ5OiBzdHJpbmcgPSB0aGlzLmJpbmFyeVZhbHVlO1xuXG4gICAgICAgIGlmICh0aGlzLlZpc3VhbEJpdHMubGVuZ3RoIDwgYmluYXJ5Lmxlbmd0aCkge1xuICAgICAgICAgICAgYmluYXJ5ID0gYmluYXJ5LnN1YnN0cmluZyhiaW5hcnkubGVuZ3RoLXRoaXMuVmlzdWFsQml0cy5sZW5ndGgpO1xuICAgICAgICAgICAgYmluYXJ5ID0gdGhpcy5zZXRDaGFyQXQoYmluYXJ5LDAsXCIxXCIpO1xuICAgICAgICAgICAgb3ZlcmZsb3cgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IHRoaXMuVmlzdWFsQml0cy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdGhpcy5WaXN1YWxCaXRzW2ldLnNldE92ZXJmbG93KG92ZXJmbG93KTtcbiAgICAgICAgICAgIHRoaXMuVmlzdWFsQml0c1tpXS5zZXRCaXQoYmluYXJ5LmNoYXJBdChpKSA9PSBcIjFcIiA/IHRydWUgOiBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVZpc3VhbEJpdHMoKSB7XG4gICAgICAgIGZvciAobGV0IGMgPSB0aGlzLmJpdHMtMTsgYyA+PSAwOyBjLS0pIHtcbiAgICAgICAgICAgIHRoaXMuVmlzdWFsQml0c1tjXT0gdGhpcy5hZGRWaXN1YWxCaXQoYyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFkZFZpc3VhbEJpdChjb2x1bW46IG51bWJlcikgOiBWaXN1YWxCaXQge1xuICAgICAgICByZXR1cm4gbmV3IFZpc3VhbEJpdCh0aGlzLmVudi5zdGFydFggKyBjb2x1bW4gKiB0aGlzLmVudi5zcGFjaW5nLCB0aGlzLmVudi5zdGFydFkgKyB0aGlzLmVudi5yYWRpdXMgKyB0aGlzLmVudi5zcGFjaW5nICogdGhpcy5yb3csIHRoaXMuZW52LnJhZGl1cywgdGhpcy5lbnYpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXREZWNpbWFsKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlY2ltYWxWYWx1ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0QmluYXJ5KCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmJpbmFyeVZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXRCaXQoaW5kZXg6IG51bWJlciwgYm9vbD86IGJvb2xlYW4pIHtcbiAgICAgICAgYm9vbCA9IGJvb2wgPz8gIXRoaXMuVmlzdWFsQml0c1tpbmRleF0uc2V0O1xuICAgICAgICB0aGlzLmJpbmFyeVZhbHVlID0gdGhpcy5zZXRDaGFyQXQodGhpcy5iaW5hcnlWYWx1ZSxpbmRleCwgYm9vbCA/IFwiMVwiOlwiMFwiKTtcbiAgICAgICAgdGhpcy5WaXN1YWxCaXRzW2luZGV4XS5zZXRCaXQoYm9vbCk7XG4gICAgICAgIHRoaXMuZGVjaW1hbFZhbHVlID0gcGFyc2VJbnQodGhpcy5iaW5hcnlWYWx1ZSwgMik7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB1cGRhdGVCaW5hcnlTdHJpbmcoKSB7XG4gICAgICAgIHRoaXMuYmluYXJ5VmFsdWUgPSB0aGlzLmRlY2ltYWxWYWx1ZS50b1N0cmluZygyKTtcbiAgICAgICAgaWYgKHRoaXMuYmluYXJ5VmFsdWUubGVuZ3RoIDwgdGhpcy5lbnYuY29sdW1ucykgdGhpcy5iaW5hcnlWYWx1ZSA9IHRoaXMuYmluYXJ5VmFsdWUucGFkU3RhcnQodGhpcy5lbnYuY29sdW1ucyxcIjBcIik7XG4gICAgfVxuXG4gICAgcHVibGljIHNldERlY2ltYWwoZGVjaW1hbFZhbHVlIDogbnVtYmVyKSB7XG4gICAgICAgIHRoaXMuZGVjaW1hbFZhbHVlID0gZGVjaW1hbFZhbHVlO1xuICAgICAgICB0aGlzLnVwZGF0ZUJpbmFyeVN0cmluZygpO1xuICAgICAgICB0aGlzLnNldENpcmNsZVZhbHVlcygpO1xuICAgIH1cblxuICAgIHByaXZhdGUgc2V0Q2hhckF0KHN0cjogc3RyaW5nLGluZGV4OiBudW1iZXIsY2hyOiBzdHJpbmcpIHtcbiAgICAgICAgaWYoaW5kZXggPiBzdHIubGVuZ3RoLTEpIHJldHVybiBzdHI7XG4gICAgICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsaW5kZXgpICsgY2hyICsgc3RyLnN1YnN0cmluZyhpbmRleCsxKTtcbiAgICB9XG59XG5cbiIsImltcG9ydCB7IHN0YXJ0IH0gZnJvbSBcInJlcGxcIjtcbmltcG9ydCB7IENoYW5nZUJpdFNpemUgfSBmcm9tIFwiLlwiO1xuaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tIFwiLi9FbnZpcm9ubWVudFwiO1xuaW1wb3J0IHsgQ29tcHV0ZSB9IGZyb20gXCIuL01hdGhIZWxwZXJcIjtcblxuLyoqXG4gKiBJbnRlcmZhY2UgdG8gaG9sZCBjb29yZGluYXRlcyBmb3IgYSBtb3VzZSBjbGljayBldmVudFxuICovXG5leHBvcnQgaW50ZXJmYWNlIG1vdXNlQ2xpY2sge1xuICAgIHg6IG51bWJlcjtcbiAgICB5OiBudW1iZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBDYW52YXNTdGFnZSB7XG4gICAgLyoqXG4gICAgICogQ29udGFpbnMgaW5mbyBhYm91dCB0aGUgY2FudmFzIERPTSBvYmplY3RcbiAgICAgKi9cbiAgICBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50O1xuICAgIGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcbiAgICBlbnZpcm9ubWVudDogRW52aXJvbm1lbnQ7XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgY2FudmFzIHRvIGRyYXcgb24sIGhhbmRsaW5nIGlucHV0XG4gICAgICogXG4gICAgICogQHBhcmFtIGVudmlyb25tZW50IC0gVGhlIEVudmlyb25tZW50IGNsYXNzIHRoYXQgY3JlYXRlZCB0aGlzIGNhbnZhc1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGVudmlyb25tZW50OiBFbnZpcm9ubWVudCkge1xuICAgICAgICB0aGlzLmVudmlyb25tZW50ID0gZW52aXJvbm1lbnQ7XG5cbiAgICAgICAgLy8gU2V0IGJhY2tncm91bmQgY29sb3IgdG8gYmxhY2tcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBcImJsYWNrXCI7XG5cbiAgICAgICAgLy8gQ3JlYXRlIGNhbnZhcyBhbmQgYXBwZW5kIHRvIHBhZ2UsIHdpdGggZXJyb3IgaGFuZGxpbmdcbiAgICAgICAgaWYgKCEodGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpIGFzIEhUTUxDYW52YXNFbGVtZW50KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIGNyZWF0ZSBjYW52YXNcIik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gU2V0IElEIG9mIHRoZSBjYW52YXMsIGZvciBDU1Mgc3R5bGluZ1xuICAgICAgICB0aGlzLmNhbnZhcy5pZCA9IFwidmlld3BvcnRcIjtcbiAgICAgICAgXG4gICAgICAgIC8vIEFwcGVuZCB0aGUgY2FudmFzIHRvIHRoZSBjb250YWluZXIgZGl2LCB3aXRoIGVycm9yIGhhbmRsaW5nXG4gICAgICAgIGxldCBjb250YWluZXJEaXY6IEhUTUxFbGVtZW50O1xuICAgICAgICBpZiAoIShjb250YWluZXJEaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbnRhaW5lclwiKSEpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gYXBwZW5kIGNhbnZhcyB0byBjb250YWluZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29udGFpbmVyRGl2LmFwcGVuZCh0aGlzLmNhbnZhcykhXG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgY29udGV4dCwgd2l0aCBlcnJvciBoYW5kbGluZ1xuICAgICAgICBpZiAoISh0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIikhKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiMmQgY29udGV4dCBub3Qgc3VwcG9ydGVkIG9yIGNhbnZhcyBhbHJlYWR5IGluaXRpYWxpemVkXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9BZGQgaW5wdXQgZXZlbnQgaGFuZGxpbmdcbiAgICAgICAgbGV0IGNsYXNzQWNjZXNzb3IgPSB0aGlzO1xuICAgICAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbihlKVxuICAgICAgICB7XG4gICAgICAgICAgICBjbGFzc0FjY2Vzc29yLm1vdXNlQ2xpY2tFdmVudChlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21wdXRlXCIpPy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIixmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBDb21wdXRlKGNsYXNzQWNjZXNzb3IuZW52aXJvbm1lbnQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgYml0c0lucHV0IDogSFRNTElucHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYml0c1wiKSEgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgaWYgKGJpdHNJbnB1dCkge1xuICAgICAgICAgICAgYml0c0lucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdmFsdWU6IG51bWJlcjtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPSBwYXJzZUludChiaXRzSW5wdXQudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIENoYW5nZUJpdFNpemUodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSBlbnZpcm9ubWVudC53aWR0aDtcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gZW52aXJvbm1lbnQuaGVpZ2h0O1xuXG4gICAgICAgIHRoaXMuZHJhd0xpbmUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gZXZlbnQgLSBNb3VzZSBjbGljayBldmVudFxuICAgICAqIEByZXR1cm5zIC0gQ29vcmRpbmF0ZXMgYXMgbW91c2VDbGljayBpbnRlcmZhY2VcbiAgICAgKi9cbiAgICBnZXRNb3VzZVBvc2l0aW9uKGV2ZW50OiBNb3VzZUV2ZW50KSA6IG1vdXNlQ2xpY2sge1xuICAgICAgICBsZXQgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCAvLyBhYnMuIHNpemUgb2YgZWxlbWVudFxuICAgICAgICBzY2FsZVggPSB0aGlzLmNhbnZhcy53aWR0aCAvIHJlY3Qud2lkdGgsICAgIC8vIHJlbGF0aW9uc2hpcCBiaXRtYXAgdnMuIGVsZW1lbnQgZm9yIHhcbiAgICAgICAgc2NhbGVZID0gdGhpcy5jYW52YXMuaGVpZ2h0IC8gcmVjdC5oZWlnaHQ7ICAvLyByZWxhdGlvbnNoaXAgYml0bWFwIHZzLiBlbGVtZW50IGZvciB5XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IChldmVudC5jbGllbnRYIC0gcmVjdC5sZWZ0KSAqIHNjYWxlWCwgICAvLyBzY2FsZSBtb3VzZSBjb29yZGluYXRlcyBhZnRlciB0aGV5IGhhdmVcbiAgICAgICAgICAgIHk6IChldmVudC5jbGllbnRZIC0gcmVjdC50b3ApICogc2NhbGVZICAgICAvLyBiZWVuIGFkanVzdGVkIHRvIGJlIHJlbGF0aXZlIHRvIGVsZW1lbnRcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVjdHMgd2hpY2ggY2lyY2xlIHdhcyBjbGlja2VkIG9uLCBhbmQgc3dpdGNoZXMgdGhhdCBiaXRcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gZSAtIFRyaWdnZXJpbmcgZXZlbnRcbiAgICAgKiBAcGFyYW0gY2FudmFzIC0gQ2FudmFzIGNsYXNzIHRoYXQgaXMgY3VycmVudGx5IGJlaW5nIHVzZWRcbiAgICAgKi9cbiAgICBtb3VzZUNsaWNrRXZlbnQoZTpNb3VzZUV2ZW50KSB7XG4gICAgICAgIGxldCBtb3VzZVBvcyA6IG1vdXNlQ2xpY2sgPSB0aGlzLmdldE1vdXNlUG9zaXRpb24oZSk7XG4gICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IHRoaXMuZW52aXJvbm1lbnQucm93czsgcm93KyspIHtcbiAgICAgICAgICAgIGNvbnN0IHNwYWNpbmcgPSB0aGlzLmVudmlyb25tZW50LnNwYWNpbmc7XG4gICAgICAgICAgICBjb25zdCBzdGFydFkgPSB0aGlzLmVudmlyb25tZW50LnN0YXJ0WTtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0WCA9IHRoaXMuZW52aXJvbm1lbnQuc3RhcnRYO1xuICAgICAgICAgICAgY29uc3QgcmFkaXVzID0gdGhpcy5lbnZpcm9ubWVudC5yYWRpdXM7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICgobW91c2VQb3MueSA+IHN0YXJ0WStyb3cqc3BhY2luZyAmJiBtb3VzZVBvcy55IDwgKHN0YXJ0WStyb3cqc3BhY2luZykrc3BhY2luZykpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCB0aGlzLmVudmlyb25tZW50LmNvbHVtbnM7IGNvbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgobW91c2VQb3MueCA+IHN0YXJ0WCArIChjb2wqc3BhY2luZy1yYWRpdXMpKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKG1vdXNlUG9zLnggPCBzdGFydFggKyAoY29sKnNwYWNpbmcrcmFkaXVzKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVudmlyb25tZW50LkJpbmFyeU51bWJlcnNbcm93XS5zZXRCaXQoY29sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERyYXdzIHRoZSBkaXZpZGVyIGxpbmUgYmV0d2VlbiB0aGUgbnVtYmVycyBhbmQgcmVzdWx0cyBkaXNwbGF5XG4gICAgICovXG4gICAgZHJhd0xpbmUoKSB7XG4gICAgICAgIHRoaXMuY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgY29uc3QgeVBvcyA6IG51bWJlciA9IHRoaXMuZW52aXJvbm1lbnQuc3RhcnRZK3RoaXMuZW52aXJvbm1lbnQuc3BhY2luZy80K3RoaXMuZW52aXJvbm1lbnQucm93cyp0aGlzLmVudmlyb25tZW50LnNwYWNpbmc7XG4gICAgICAgIGNvbnN0IHhQb3MgOiBudW1iZXIgPSB0aGlzLmVudmlyb25tZW50LnN0YXJ0WCAtIHRoaXMuZW52aXJvbm1lbnQucmFkaXVzO1xuICAgICAgICB0aGlzLmNvbnRleHQubW92ZVRvKHhQb3MsIHlQb3MpO1xuICAgICAgICB0aGlzLmNvbnRleHQubGluZVRvKHhQb3MgKyB0aGlzLmVudmlyb25tZW50LmNvbHVtbnMqdGhpcy5lbnZpcm9ubWVudC5zcGFjaW5nLCAgeVBvcyk7XG4gICAgICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9IFwid2hpdGVcIjtcbiAgICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICB0aGlzLmNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgfVxuXG4gICAgZHJhd0J1dHRvbnMoKSB7XG5cbiAgICB9XG59XG5cbiIsIi8qKlxuICogSW52b2tlcyB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gYWZ0ZXIgYSB3YWl0IHRpbWUgYmVnaW5uaW5nIGFmdGVyIHRoZSByZXR1cm4gZnVuY3Rpb24gc3RvcHMgYmVpbmcgY2FsbGVkLlxuICogXG4gKiBAcGFyYW0gY2FsbGJhY2sgLSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gZG9uZSBkZWJvdW5jaW5nXG4gKiBAcGFyYW0gd2FpdCAtIFdhaXQgdGltZVxuICogQHJldHVybnMgLSBGdW5jdGlvbiB0byBiZSBjYWxsZWQgKHJlcGVhdGVkbHkpIGJ5IHRoZSBhY3Rpb24gdG8gYmUgZGVib3VuY2VkICh3aW5kb3cgcmVzaXplLCBldGMpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWJvdW5jZTxUIGV4dGVuZHMgdW5rbm93bltdLCBVPihcbiAgICBjYWxsYmFjazogKC4uLmFyZ3M6IFQpID0+IFByb21pc2VMaWtlPFU+IHwgVSxcbiAgICB3YWl0OiBudW1iZXJcbiAgKSB7XG4gICAgbGV0IHN0YXRlOlxuICAgICAgfCB1bmRlZmluZWRcbiAgICAgIHwge1xuICAgICAgICAgIHRpbWVvdXQ6IFJldHVyblR5cGU8dHlwZW9mIHNldFRpbWVvdXQ+XG4gICAgICAgICAgcHJvbWlzZTogUHJvbWlzZTxVPlxuICAgICAgICAgIHJlc29sdmU6ICh2YWx1ZTogVSB8IFByb21pc2VMaWtlPFU+KSA9PiB2b2lkXG4gICAgICAgICAgcmVqZWN0OiAodmFsdWU6IGFueSkgPT4gdm9pZFxuICAgICAgICAgIGxhdGVzdEFyZ3M6IFRcbiAgICAgICAgfSA9IHVuZGVmaW5lZFxuICBcbiAgICByZXR1cm4gKC4uLmFyZ3M6IFQpOiBQcm9taXNlPFU+ID0+IHtcbiAgICAgIGlmICghc3RhdGUpIHtcbiAgICAgICAgc3RhdGUgPSB7fSBhcyBhbnlcbiAgICAgICAgc3RhdGUhLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgc3RhdGUhLnJlc29sdmUgPSByZXNvbHZlXG4gICAgICAgICAgc3RhdGUhLnJlamVjdCA9IHJlamVjdFxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgY2xlYXJUaW1lb3V0KHN0YXRlIS50aW1lb3V0KVxuICAgICAgc3RhdGUhLmxhdGVzdEFyZ3MgPSBhcmdzXG4gICAgICBzdGF0ZSEudGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBjb25zdCBzID0gc3RhdGUhXG4gICAgICAgIHN0YXRlID0gdW5kZWZpbmVkXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcy5yZXNvbHZlKGNhbGxiYWNrKC4uLnMubGF0ZXN0QXJncykpXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBzLnJlamVjdChlKVxuICAgICAgICB9XG4gICAgICB9LCB3YWl0KVxuICBcbiAgICAgIHJldHVybiBzdGF0ZSEucHJvbWlzZVxuICAgIH1cbiAgfSIsImltcG9ydCB7IFZpc3VhbEJpdCB9IGZyb20gXCIuL1Zpc3VhbEJpdFwiO1xuaW1wb3J0IHsgQ2FudmFzU3RhZ2UgfSBmcm9tIFwiLi9DYW52YXNTdGFnZVwiO1xuaW1wb3J0IHsgQmluYXJ5TnVtYmVyIH0gZnJvbSBcIi4vQmluYXJ5TnVtYmVyXCI7XG5cbmV4cG9ydCBjbGFzcyBFbnZpcm9ubWVudCB7XG4gICAgLyoqXG4gICAgICogQ29udGFpbnMgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHZpc3VhbCBjYWxjdWxhdG9yXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBBbiBhcnJheSwgZmlyc3QgZGltZW5zaW9uIGlzIHRoZSByb3cgKG51bWJlciksIHNlY29uZCBkaW1lbnNpb24gaXMgdGhlIGNvbHVtbiAoYml0KVxuICAgICAqL1xuICAgIGNpcmNsZXM6VmlzdWFsQml0W11bXTtcblxuICAgIC8qKlxuICAgICAqIE51bWJlciBjbGFzcyBhcnJheSwgZWFjaCBOdW1iZXIgaG9sZHMgYSByb3cgKG51bWJlcilcbiAgICAgKi9cbiAgICBCaW5hcnlOdW1iZXJzOkJpbmFyeU51bWJlcltdO1xuXG4gICAgLyoqXG4gICAgICogQSBCaW5hcnlOdW1iZXIgdG8gZGlzcGxheSB0aGUgcmVzdWx0c1xuICAgICAqL1xuICAgIHJlc3VsdHM6QmluYXJ5TnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogUmFkaXVzIG9mIHRoZSBjaXJjbGUsIGNvbXB1dGVkIGJhc2VkIG9uIHdpbmRvdyB3aWR0aFxuICAgICAqL1xuICAgIHJhZGl1czpudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBTdGFydGluZyBwb3NpdGlvbiB0byBkcmF3IGNvbHVtbnNcbiAgICAgKi9cbiAgICBzdGFydFg6bnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogU3RhcnRpbmcgcG9zaXRpb24gdG8gZHJhdyByb3dzXG4gICAgICovXG4gICAgc3RhcnRZOm51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIE51bWJlciBvZiBiaXRzIChjb2x1bW5zKSBwZXIgbnVtYmVyXG4gICAgICovXG4gICAgY29sdW1uczpudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBOdW1iZXIgb2YgbnVtYmVycyAocm93cylcbiAgICAgKi9cbiAgICByb3dzOm51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFNwYWNpbmcgaXMgdGhlIHRvdGFsIHNwYWNlIHRoYXQgZWFjaCBjaXJjbGUgdGFrZXMgdXAgd2l0aCBwYWRkaW5nXG4gICAgICovXG4gICAgc3BhY2luZzpudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY2FudmFzIHRvIGRyYXcgb25cbiAgICAgKi9cbiAgICBjYW52YXM6Q2FudmFzU3RhZ2U7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggb2YgdGhlIGNhbnZhc1xuICAgICAqL1xuICAgIHdpZHRoOm51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFRoZSBoZWlnaHQgb2YgdGhlIGNhbnZhc1xuICAgICAqL1xuICAgIGhlaWdodDpudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgcGFkZGluZyBzdXJyb3VuZGluZyB0aGUgZHJhdyBhcmVhXG4gICAgICovXG4gICAgcGFnZVBhZGRpbmc6bnVtYmVyID0gMTA7XG5cbiAgICAvKipcbiAgICAgKiBNaW5pbXVtIHJhZGl1cyBvZiBjaXJjbGUgaW4gcGl4ZWxzXG4gICAgICovXG4gICAgbWluV2lkdGg6bnVtYmVyID0gMTA7XG5cbiAgICAvKipcbiAgICAgKiBNYXhpbXVtIGJpdHMgdGhlIHBhZ2UgY2FuIGZpdFxuICAgICAqL1xuICAgIE1heEJpdHM6bnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNhbnZhcyBhbmQgZHJhd3MgY2lyY2xlcyBvbiBpdCB0byByZXByZXNlbnQgKHJvdykgYmluYXJ5IG51bWJlcnMgb2YgKGNvbHVtbnMpIGJpdCBsZW5ndGguXG4gICAgICogQHBhcmFtIGNvbHVtbnMgLSBOdW1iZXIgb2YgY29sdW1ucyAoYml0cylcbiAgICAgKiBAcGFyYW0gcm93cyAtIE51bWJlciBvZiByb3dzIChudW1iZXJzKVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGNvbHVtbnM6bnVtYmVyLHJvd3M6bnVtYmVyKSB7XG4gICAgICAgIHRoaXMuY29sdW1ucyA9IGNvbHVtbnM7XG4gICAgICAgIHRoaXMucm93cyA9IHJvd3M7XG4gICAgICAgIGxldCBwYWRkaW5nOiBudW1iZXIgPSA1O1xuXG4gICAgICAgIC8vRGV0ZXJtaW5lIHRoZSBkcmF3aW5nIGFyZWEgc2l6ZVxuICAgICAgICB0aGlzLndpZHRoID0gTWF0aC5taW4od2luZG93LmlubmVyV2lkdGgsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCkgLSAodGhpcy5wYWdlUGFkZGluZyoyKTtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBNYXRoLm1pbih3aW5kb3cuaW5uZXJIZWlnaHQsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpIC0gKHRoaXMucGFnZVBhZGRpbmcqMik7XG5cbiAgICAgICAgLy9NYXhpbXVtIGNvbHVtbnMgd2UgY291bGQgaGF2ZSB3aXRoIHRoZSBtaW5XaWR0aFxuICAgICAgICB0aGlzLk1heEJpdHMgPSAgTWF0aC5mbG9vcigodGhpcy53aWR0aCkgLyAoKHRoaXMubWluV2lkdGgqMikrcGFkZGluZykpO1xuICAgICAgICB0aGlzLmNvbHVtbnMgPSBNYXRoLm1heChNYXRoLm1pbih0aGlzLk1heEJpdHMsIHRoaXMuY29sdW1ucyksMik7XG4gICAgICAgIGxldCBiaXRJbnB1dCA6IEhUTUxJbnB1dEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJpdHNcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgYml0SW5wdXQudmFsdWUgPSB0aGlzLmNvbHVtbnMudG9TdHJpbmcoKTtcblxuICAgICAgICAvLyBDb21wdXRlIHRoZSBtYXhpbXVtIHJhZGl1cyB0aGF0IGFsbG93cyBhbGwgdGhlIGNpcmNsZXMgdG8gZml0IG9uIHRoZSBwYWdlXG4gICAgICAgIHRoaXMucmFkaXVzID0gTWF0aC5tYXgoXG4gICAgICAgICAgICB0aGlzLm1pbldpZHRoLFxuICAgICAgICAgICAgTWF0aC5mbG9vcihcbiAgICAgICAgICAgICAgICBNYXRoLm1pbihcbiAgICAgICAgICAgICAgICAgICAgKCgodGhpcy53aWR0aCkgLSBwYWRkaW5nKnRoaXMuY29sdW1ucykvMikgLyB0aGlzLmNvbHVtbnMsXG4gICAgICAgICAgICAgICAgICAgICgoKHRoaXMuaGVpZ2h0KSAtIChwYWRkaW5nKih0aGlzLnJvd3MrMikpKS8yKSAvICh0aGlzLnJvd3MrMilcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICAvL1RoZSBzcGFjZSBiZXR3ZWVuIGVhY2ggY2lyY2xlXG4gICAgICAgIHRoaXMuc3BhY2luZyA9IHRoaXMucmFkaXVzICogMiArIHBhZGRpbmc7XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBzdGFydGluZyBwb3NpdGlvbiB0byBkcmF3IHRoZSBjaXJjbGVzXG4gICAgICAgIGxldCB0b3RhbFdpZHRoID0gdGhpcy5jb2x1bW5zICogdGhpcy5zcGFjaW5nIC0gcGFkZGluZyoyO1xuICAgICAgICBsZXQgc3RhcnRYID0gKHRoaXMud2lkdGggLSB0b3RhbFdpZHRoKSAvIDIgKyB0aGlzLnJhZGl1cztcbiAgICAgICAgbGV0IHRvdGFsSGVpZ2h0ID0gKCh0aGlzLnJvd3MrMikgKiB0aGlzLnNwYWNpbmcpIC0gcGFkZGluZyoyO1xuICAgICAgICBsZXQgc3RhcnRZID0gKHRoaXMuaGVpZ2h0IC0gdG90YWxIZWlnaHQpIC8gMjtcblxuICAgICAgICB0aGlzLnN0YXJ0WCA9IHN0YXJ0WDtcbiAgICAgICAgdGhpcy5zdGFydFkgPSBzdGFydFk7XG5cbiAgICAgICAgLy8gSW5pdCBjaXJjbGUgYXJyYXlcbiAgICAgICAgdGhpcy5jaXJjbGVzID0gbmV3IEFycmF5KHRoaXMucm93cyk7XG4gICAgICAgIHRoaXMuQmluYXJ5TnVtYmVycyA9IG5ldyBBcnJheSh0aGlzLnJvd3MpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBjYW52YXMgdG8gZHJhdyBvblxuICAgICAgICB0aGlzLmNhbnZhcyA9IG5ldyBDYW52YXNTdGFnZSh0aGlzKTtcbiAgICAgICAgdGhpcy5yZXN1bHRzID0gbmV3IEJpbmFyeU51bWJlcih0aGlzLHRoaXMucm93cysxKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZXMgdGhlIGNpcmNsZXMgZm9yIGVhY2ggcm93IChudW1iZXIpIHdpdGggdGhlIGFtb3VudCBvZiBiaXRzIChjb2x1bW5zKSByZXF1ZXN0ZWQuXG4gICAgICAgIGZvciAobGV0IHIgPSAwOyByIDwgdGhpcy5yb3dzOyByKyspIHtcbiAgICAgICAgICAgIHRoaXMuQmluYXJ5TnVtYmVyc1tyXSA9IG5ldyBCaW5hcnlOdW1iZXIodGhpcyxyKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCJpbXBvcnQgeyBDaGFuZ2VCaXRTaXplIH0gZnJvbSBcIi5cIjtcbmltcG9ydCB7IEJpbmFyeU51bWJlciB9IGZyb20gXCIuL0JpbmFyeU51bWJlclwiO1xuaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tIFwiLi9FbnZpcm9ubWVudFwiO1xuXG4vKipcbiAqIENvbnZlcnRzIGJpbmFyeSByZXByZXNlbnRhdGlvbiB0byBkZWNpbWFsLCBwZXJmb3JtcyB0aGUgZGVzaXJlZCBtYXRoIGZ1bmN0aW9uLCB0aGVuIGRpc3BsYXlzIHRoZSByZXN1bHRzIGluIGJpbmFyeVxuICogQHBhcmFtIGVudiAtIEVudmlyb25tZW50IHVzZWQgdG8gY29tcHV0ZSB2YWx1ZXNcbiAqIFxuICogVE9ETzogQWxsb3cgY2hvb3Npbmcgb2Ygb3BlcmFuZCAoYWRkLHN1YnRyYWN0LG11bHRpcGx5LGRpdmlkZSlcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIENvbXB1dGUoZW52OiBFbnZpcm9ubWVudCk6IHZvaWQge1xuXG4gICAgbGV0IHJlc3VsdHM6bnVtYmVyID0gMDtcbiAgICBmb3IgKGxldCByID0gMDsgciA8IGVudi5yb3dzOyByKyspIHtcbiAgICAgICAgcmVzdWx0cyArPSBlbnYuQmluYXJ5TnVtYmVyc1tyXS5nZXREZWNpbWFsKCk7XG4gICAgfVxuICAgIGVudi5yZXN1bHRzLnNldERlY2ltYWwocmVzdWx0cyk7XG59IiwiaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tIFwiLi9FbnZpcm9ubWVudFwiO1xuXG5leHBvcnQgY2xhc3MgVmlzdWFsQml0IHtcbiAgICAvKipcbiAgICAgKiBDbGFzcyB0aGF0IGhvbGRzIGluZm8gYWJvdXQgYSBjaXJjbGUgZHJhd24gb24gYW4gSFRNTCBjYW52YXMsIHJlcHJlc2VudGluZyBhIHZpc3VhbCBiaXQgb2YgZGF0YS5cbiAgICAgKi9cblxuICAgIHNldDpCb29sZWFuO1xuICAgIHg6bnVtYmVyO1xuICAgIHk6bnVtYmVyO1xuICAgIHJhZGl1czpudW1iZXI7XG4gICAgbGVmdDogbnVtYmVyO1xuICAgIHRvcDogbnVtYmVyO1xuICAgIHJpZ2h0OiBudW1iZXI7XG4gICAgYm90dG9tOiBudW1iZXI7XG4gICAgZW52OiBFbnZpcm9ubWVudDtcbiAgICBmaWxsQ29sb3I6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB4IENlbnRlcnBvaW50IFggY29vcmRpbmF0ZSB0byBkcmF3IGNpcmNsZVxuICAgICAqIEBwYXJhbSB5IENlbnRlcnBvaW50IFkgY29vcmRpbmF0ZSB0byBkcmF3IGNpcmNsZVxuICAgICAqIEBwYXJhbSByYWRpdXMgUmFkaXVzIG9mIGNpcmNsZSB0byBkcmF3XG4gICAgICogQHBhcmFtIGVudiBDYW52YXMgY29udGV4dCB0byBkcmF3IG9uXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoeCA6IG51bWJlciwgeTogbnVtYmVyLCByYWRpdXM6bnVtYmVyLCBlbnY6IEVudmlyb25tZW50KVxuICAgIGNvbnN0cnVjdG9yKHggOiBudW1iZXIsIHk6IG51bWJlciwgcmFkaXVzOm51bWJlciwgZW52OiBFbnZpcm9ubWVudCwgc2V0PzpCb29sZWFuKSB7XG4gICAgICAgIHRoaXMueCA9IHg7XG4gICAgICAgIHRoaXMueSA9IHk7XG4gICAgICAgIHRoaXMuc2V0ID0gc2V0ID8/IGZhbHNlO1xuICAgICAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cztcbiAgICAgICAgdGhpcy5sZWZ0ID0gdGhpcy54LXJhZGl1cy0xO1xuICAgICAgICB0aGlzLnRvcCA9IHRoaXMueS1yYWRpdXMtMTtcbiAgICAgICAgdGhpcy5yaWdodCA9IHRoaXMueCtyYWRpdXMrMTtcbiAgICAgICAgdGhpcy5ib3R0b20gPSB0aGlzLnkrcmFkaXVzKzE7XG4gICAgICAgIHRoaXMuZW52ID0gZW52O1xuICAgICAgICB0aGlzLmZpbGxDb2xvciA9IFwid2hpdGVcIjtcbiAgICAgICAgdGhpcy5kcmF3KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3dpdGNoZXMgdGhlIGJpdCB2YWx1ZSBhbmQgcmVkcmF3XG4gICAgICovXG4gICAgc3dpdGNoQml0KCkge1xuICAgICAgICB0aGlzLnNldCA9ICF0aGlzLnNldDtcbiAgICAgICAgdGhpcy5kcmF3KCk7XG4gICAgICAgIFxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldHMgdGhlIGJpdCB2YWx1ZSBmb3IgdGhlIGNpcmNsZSB0byB0aGUgcHJvdmlkZWQgYml0IGFuZCByZWRyYXdcbiAgICAgKiBAcGFyYW0gYml0IC0gU2V0dGluZyB0byBhcHBseSB0byB0aGUgYml0XG4gICAgICovXG4gICAgc2V0Qml0KGJpdDogYm9vbGVhbikge1xuICAgICAgICB0aGlzLnNldCA9IGJpdDtcbiAgICAgICAgdGhpcy5kcmF3KCk7XG4gICAgfVxuXG4gICAgc2V0T3ZlcmZsb3cob3ZlcmZsb3c6IGJvb2xlYW4pIHtcbiAgICAgICAgaWYob3ZlcmZsb3cpIHRoaXMuZmlsbENvbG9yID0gXCJyZWRcIjsgXG4gICAgICAgIGVsc2UgdGhpcy5maWxsQ29sb3IgPSBcIndoaXRlXCI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRHJhd3MgdGhlIGNpcmNsZVxuICAgICAqIEBwYXJhbSBjb250ZXh0IC0gVGhlIGNhbnZhcyBjb250ZXh0IHRvIGRyYXcgb25cbiAgICAgKi9cbiAgICBkcmF3KCk6IHZvaWQge1xuICAgICAgICBjb25zdCBjb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQgPSB0aGlzLmVudi5jYW52YXMuY29udGV4dDtcbiAgICAgICAgY29udGV4dC5jbGVhclJlY3QodGhpcy5sZWZ0LCB0aGlzLnRvcCwgdGhpcy5yYWRpdXMqMisyLCB0aGlzLnJhZGl1cyoyKzIpO1xuICAgICAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgICAgICBjb250ZXh0LmFyYyh0aGlzLngsIHRoaXMueSwgdGhpcy5yYWRpdXMsIDAsIDIgKiBNYXRoLlBJKTtcbiAgICAgICAgY29udGV4dC5maWxsU3R5bGUgPSB0aGlzLnNldCA/IHRoaXMuZmlsbENvbG9yIDogXCIjMGYwZjBmXCI7XG4gICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSB0aGlzLnNldCA/IFwiIzk1YzI5OVwiIDogXCIjMzMwNDAwXCIgO1xuICAgICAgICBjb250ZXh0LmZpbGwoKTtcbiAgICAgICAgY29udGV4dC5zdHJva2UoKTtcbiAgICAgICAgY29udGV4dC5jbG9zZVBhdGgoKTtcbiAgICB9XG59IiwiaW1wb3J0IHsgQmluYXJ5TnVtYmVyIH0gZnJvbSBcIi4vQmluYXJ5TnVtYmVyXCI7XG5pbXBvcnQgeyBkZWJvdW5jZSB9IGZyb20gXCIuL0RlYm91bmNlVmFsdWVcIjtcbmltcG9ydCB7IEVudmlyb25tZW50IH0gZnJvbSBcIi4vRW52aXJvbm1lbnRcIjtcblxubGV0IGVudjogRW52aXJvbm1lbnQ7XG5sZXQgZGVib3VuY2VXaW5kb3dSZXNpemUgPSBkZWJvdW5jZShEZWxldGVDYW52YXMsIDIwMCk7XG5sZXQgZGVib3VuY2VCaXRSZXNpemUgPSBkZWJvdW5jZShjaGFuZ2VCaXRzLCAyMDApO1xubGV0IGNvbHVtbnM6IG51bWJlciA9IDg7XG5sZXQgcm93czogbnVtYmVyID0gMjtcblxuQ3JlYXRlKCk7XG5cbi8qKlxuICogSGFuZGxlcyB0aGUgY3JlYXRpb24gb2YgdGhlIEVudmlyb25tZW50LiBBZGRzIGEgaGFuZGxlciB0byB0aGUgd2luZG93IHRoYXQgd2lsbCByZWNyZWF0ZSB0aGUgRW52aXJvbm1lbnQgd2hlbmV2ZXIgdGhlIHdpbmRvdyBpcyByZXNpemVkLlxuICovXG5mdW5jdGlvbiBDcmVhdGUoKSB7XG4gICAgQ3JlYXRlRW52aXJvbm1lbnQoKTtcblxuICAgIC8vIERlYm91bmNlZCB3aW5kb3cgcmVzaXplIGlucHV0IGhhbmRsZXJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGRlYm91bmNlV2luZG93UmVzaXplKCk7XG4gICAgfSk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBFbnZpcm9ubWVudFxuICovXG5mdW5jdGlvbiBDcmVhdGVFbnZpcm9ubWVudCgpOiB2b2lkIHtcbiAgICBlbnYgPSBuZXcgRW52aXJvbm1lbnQoY29sdW1ucyxyb3dzKTtcbn1cblxuLyoqXG4gKiBEZWxldGVzIHRoZSBDYW52YXMsIGFuZCBjcmVhdGVzIGEgbmV3IEVudmlyb25tZW50XG4gKi9cbmZ1bmN0aW9uIERlbGV0ZUNhbnZhcygpe1xuICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZXdwb3J0XCIpICE9IG51bGwpIHtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ2aWV3cG9ydFwiKSEucmVtb3ZlKCk7XG5cbiAgICAgICAgY29uc3Qgc3RvcmVOdW1iZXJzOiBCaW5hcnlOdW1iZXJbXSA9IGVudi5CaW5hcnlOdW1iZXJzO1xuICAgICAgICBjb25zdCByZXN1bHROdW1iZXI6IEJpbmFyeU51bWJlciA9IGVudi5yZXN1bHRzO1xuXG4gICAgICAgIENyZWF0ZUVudmlyb25tZW50KCk7XG5cbiAgICAgICAgZW52LnJlc3VsdHMuc2V0RGVjaW1hbChyZXN1bHROdW1iZXIuZ2V0RGVjaW1hbCgpKTtcbiAgICAgICAgXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RvcmVOdW1iZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbGV0IGJpbmFyeVZhbHVlID0gc3RvcmVOdW1iZXJzW2ldLmdldEJpbmFyeSgpO1xuICAgICAgICAgICAgICAgIGJpbmFyeVZhbHVlID0gYmluYXJ5VmFsdWUuc3Vic3RyaW5nKGJpbmFyeVZhbHVlLmxlbmd0aC1jb2x1bW5zKTtcbiAgICAgICAgICAgICAgICBlbnYuQmluYXJ5TnVtYmVyc1tpXS5zZXREZWNpbWFsKHBhcnNlSW50KGJpbmFyeVZhbHVlLDIpKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIENoYW5nZUJpdFNpemUoYml0czogbnVtYmVyKSB7XG4gICAgZGVib3VuY2VCaXRSZXNpemUoYml0cyk7XG59XG5cbmZ1bmN0aW9uIGNoYW5nZUJpdHMoYml0czogbnVtYmVyKSB7XG4gICAgYml0cyA9IE1hdGgubWluKGVudi5NYXhCaXRzLGJpdHMpO1xuICAgIGJpdHMgPSBNYXRoLm1heCgyLGJpdHMpO1xuICAgIGxldCBiaXRJbnB1dCA6IEhUTUxJbnB1dEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJpdHNcIikgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICBiaXRJbnB1dC52YWx1ZSA9IGJpdHMudG9TdHJpbmcoKTtcbiAgICBjb2x1bW5zID0gYml0cztcbiAgICBEZWxldGVDYW52YXMoKTtcbn1cbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oNjA3KTtcbiJdLCJuYW1lcyI6WyJlbnYiLCJyb3ciLCJkZWNpbWFsVmFsdWUiLCJ0aGlzIiwiYmluYXJ5VmFsdWUiLCJ0b1N0cmluZyIsIm5ld0JpdHMiLCJNYXRoIiwicm91bmQiLCJsZW5ndGgiLCJiaXRzIiwiY29sdW1ucyIsIlZpc3VhbEJpdHMiLCJBcnJheSIsImNyZWF0ZVZpc3VhbEJpdHMiLCJzZXREZWNpbWFsIiwic2V0Q2lyY2xlVmFsdWVzIiwib3ZlcmZsb3ciLCJiaW5hcnkiLCJzdWJzdHJpbmciLCJzZXRDaGFyQXQiLCJpIiwic2V0T3ZlcmZsb3ciLCJzZXRCaXQiLCJjaGFyQXQiLCJjIiwiYWRkVmlzdWFsQml0IiwiY29sdW1uIiwiVmlzdWFsQml0Iiwic3RhcnRYIiwic3BhY2luZyIsInN0YXJ0WSIsInJhZGl1cyIsImdldERlY2ltYWwiLCJnZXRCaW5hcnkiLCJpbmRleCIsImJvb2wiLCJzZXQiLCJwYXJzZUludCIsInVwZGF0ZUJpbmFyeVN0cmluZyIsInBhZFN0YXJ0Iiwic3RyIiwiY2hyIiwiQmluYXJ5TnVtYmVyIiwiZW52aXJvbm1lbnQiLCJjb250YWluZXJEaXYiLCJkb2N1bWVudCIsImJvZHkiLCJzdHlsZSIsImJhY2tncm91bmRDb2xvciIsImNhbnZhcyIsImNyZWF0ZUVsZW1lbnQiLCJFcnJvciIsImlkIiwiZ2V0RWxlbWVudEJ5SWQiLCJhcHBlbmQiLCJjb250ZXh0IiwiZ2V0Q29udGV4dCIsImNsYXNzQWNjZXNzb3IiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsIm1vdXNlQ2xpY2tFdmVudCIsIkNvbXB1dGUiLCJiaXRzSW5wdXQiLCJ2YWx1ZSIsIkNoYW5nZUJpdFNpemUiLCJ3aWR0aCIsImhlaWdodCIsImRyYXdMaW5lIiwiZ2V0TW91c2VQb3NpdGlvbiIsImV2ZW50IiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInNjYWxlWCIsInNjYWxlWSIsIngiLCJjbGllbnRYIiwibGVmdCIsInkiLCJjbGllbnRZIiwidG9wIiwibW91c2VQb3MiLCJyb3dzIiwiY29sIiwiQmluYXJ5TnVtYmVycyIsImJlZ2luUGF0aCIsInlQb3MiLCJ4UG9zIiwibW92ZVRvIiwibGluZVRvIiwic3Ryb2tlU3R5bGUiLCJzdHJva2UiLCJjbG9zZVBhdGgiLCJkcmF3QnV0dG9ucyIsIkNhbnZhc1N0YWdlIiwiY2FsbGJhY2siLCJ3YWl0Iiwic3RhdGUiLCJ1bmRlZmluZWQiLCJwcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjbGVhclRpbWVvdXQiLCJ0aW1lb3V0IiwibGF0ZXN0QXJncyIsImFyZ3MiLCJzZXRUaW1lb3V0IiwicyIsIkVudmlyb25tZW50IiwicGFnZVBhZGRpbmciLCJtaW5XaWR0aCIsIm1pbiIsIndpbmRvdyIsImlubmVyV2lkdGgiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsImlubmVySGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiTWF4Qml0cyIsImZsb29yIiwibWF4IiwidG90YWxXaWR0aCIsInBhZGRpbmciLCJ0b3RhbEhlaWdodCIsImNpcmNsZXMiLCJyZXN1bHRzIiwiciIsInJpZ2h0IiwiYm90dG9tIiwiZmlsbENvbG9yIiwiZHJhdyIsInN3aXRjaEJpdCIsImJpdCIsImNsZWFyUmVjdCIsImFyYyIsIlBJIiwiZmlsbFN0eWxlIiwiZmlsbCIsImRlYm91bmNlV2luZG93UmVzaXplIiwiZGVib3VuY2UiLCJEZWxldGVDYW52YXMiLCJkZWJvdW5jZUJpdFJlc2l6ZSIsIkNyZWF0ZUVudmlyb25tZW50IiwicmVtb3ZlIiwic3RvcmVOdW1iZXJzIiwicmVzdWx0TnVtYmVyIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iXSwic291cmNlUm9vdCI6IiJ9