(()=>{"use strict";var t={765:(t,i,e)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.BinaryNumber=void 0;var s=e(399),n=function(){function t(t,i,e){this.env=t,this.row=i,this.decimalValue=null!=e?e:0,this.binaryValue=this.decimalValue.toString(2);var s=2*Math.round(this.binaryValue.length/2);this.bits=s>this.env.columns?s:this.env.columns,this.VisualBits=new Array(this.bits),this.createVisualBits(),this.setDecimal(this.decimalValue)}return t.prototype.setCircleValues=function(){var t=!1,i=this.binaryValue;this.VisualBits.length<i.length&&(i=i.substring(i.length-this.VisualBits.length),i=this.setCharAt(i,0,"1"),t=!0);for(var e=this.VisualBits.length-1;e>=0;e--)this.VisualBits[e].setOverflow(t),this.VisualBits[e].setBit("1"==i.charAt(e))},t.prototype.createVisualBits=function(){for(var t=this.bits-1;t>=0;t--)this.VisualBits[t]=this.addVisualBit(t)},t.prototype.addVisualBit=function(t){return new s.VisualBit(this.env.startX+t*this.env.spacing,this.env.startY+this.env.radius+this.env.spacing*this.row,this.env.radius,this.env)},t.prototype.getDecimal=function(){return this.decimalValue},t.prototype.getBinary=function(){return this.binaryValue},t.prototype.setBit=function(t,i){i=null!=i?i:!this.VisualBits[t].set,this.binaryValue=this.setCharAt(this.binaryValue,t,i?"1":"0"),this.VisualBits[t].setBit(i),this.decimalValue=parseInt(this.binaryValue,2)},t.prototype.updateBinaryString=function(){this.binaryValue=this.decimalValue.toString(2),this.binaryValue.length<this.env.columns&&(this.binaryValue=this.binaryValue.padStart(this.env.columns,"0"))},t.prototype.setDecimal=function(t){this.decimalValue=t,this.updateBinaryString(),this.setCircleValues()},t.prototype.setCharAt=function(t,i,e){return i>t.length-1?t:t.substring(0,i)+e+t.substring(i+1)},t}();i.BinaryNumber=n},438:(t,i,e)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.CanvasStage=void 0;var s=e(607),n=e(251),r=function(){function t(t){var i,e;if(this.environment=t,document.body.style.backgroundColor="black",!(this.canvas=document.createElement("canvas")))throw new Error("Unable to create canvas");if(this.canvas.id="viewport",!(e=document.getElementById("main")))throw new Error("Unable to append canvas to container");if(e.append(this.canvas),!(this.context=this.canvas.getContext("2d")))throw new Error("2d context not supported or canvas already initialized");var r=this;this.canvas.addEventListener("mouseup",(function(t){r.mouseClickEvent(t)})),null===(i=document.getElementById("compute"))||void 0===i||i.addEventListener("click",(function(t){(0,n.Compute)(r.environment)}));var a=document.getElementById("bits");a&&a.addEventListener("input",(function(t){var i;(i=parseInt(a.value))&&(0,s.ChangeBitSize)(i)})),this.canvas.width=t.width,this.canvas.height=t.height,this.drawLine()}return t.prototype.getMousePosition=function(t){var i=this.canvas.getBoundingClientRect(),e=this.canvas.width/i.width,s=this.canvas.height/i.height;return{x:(t.clientX-i.left)*e,y:(t.clientY-i.top)*s}},t.prototype.mouseClickEvent=function(t){for(var i=this.getMousePosition(t),e=0;e<this.environment.rows;e++){var s=this.environment.spacing,n=this.environment.startY,r=this.environment.startX,a=this.environment.radius;if(i.y>n+e*s&&i.y<n+e*s+s)for(var o=0;o<this.environment.columns;o++)i.x>r+(o*s-a)&&i.x<r+(o*s+a)&&this.environment.BinaryNumbers[e].setBit(o)}},t.prototype.drawLine=function(){this.context.beginPath();var t=this.environment.startY+this.environment.spacing/4+this.environment.rows*this.environment.spacing,i=this.environment.startX-this.environment.radius;this.context.moveTo(i,t),this.context.lineTo(i+this.environment.columns*this.environment.spacing,t),this.context.strokeStyle="white",this.context.stroke(),this.context.closePath()},t.prototype.drawButtons=function(){},t}();i.CanvasStage=r},115:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.debounce=void 0,i.debounce=function(t,i){var e=void 0;return function(){for(var s=[],n=0;n<arguments.length;n++)s[n]=arguments[n];return e||((e={}).promise=new Promise((function(t,i){e.resolve=t,e.reject=i}))),clearTimeout(e.timeout),e.latestArgs=s,e.timeout=setTimeout((function(){var i=e;e=void 0;try{i.resolve(t.apply(void 0,i.latestArgs))}catch(t){i.reject(t)}}),i),e.promise}}},116:(t,i,e)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Environment=void 0;var s=e(438),n=e(765);i.Environment=function(t,i){this.pagePadding=10,this.minWidth=10,this.columns=t,this.rows=i,this.width=document.getElementById("main").offsetWidth-2*this.pagePadding,this.height=document.getElementById("main").offsetHeight-2*this.pagePadding,this.MaxBits=Math.floor(this.width/(2*this.minWidth+5)),this.columns=Math.max(Math.min(this.MaxBits,this.columns),2),document.getElementById("bits").value=this.columns.toString(),this.radius=Math.max(this.minWidth,Math.floor(Math.min((this.width-5*this.columns)/2/this.columns,(this.height-5*(this.rows+2))/2/(this.rows+2)))),this.spacing=2*this.radius+5;var e=this.columns*this.spacing-10,r=(this.width-e)/2+this.radius,a=(this.rows+2)*this.spacing,o=(this.height-a)/2;this.startX=r,this.startY=o,this.circles=new Array(this.rows),this.BinaryNumbers=new Array(this.rows),this.canvas=new s.CanvasStage(this),this.results=new n.BinaryNumber(this,this.rows+1);for(var h=0;h<this.rows;h++)this.BinaryNumbers[h]=new n.BinaryNumber(this,h)}},251:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.Compute=void 0,i.Compute=function(t){for(var i=0,e=0;e<t.rows;e++)i+=t.BinaryNumbers[e].getDecimal();t.results.setDecimal(i)}},399:(t,i)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.VisualBit=void 0;var e=function(){function t(t,i,e,s,n){this.x=t,this.y=i,this.set=null!=n&&n,this.radius=e,this.left=this.x-e-1,this.top=this.y-e-1,this.right=this.x+e+1,this.bottom=this.y+e+1,this.env=s,this.fillColor="white",this.draw()}return t.prototype.switchBit=function(){this.set=!this.set,this.draw()},t.prototype.setBit=function(t){this.set=t,this.draw()},t.prototype.setOverflow=function(t){this.fillColor=t?"red":"white"},t.prototype.draw=function(){var t=this.env.canvas.context;t.clearRect(this.left,this.top,2*this.radius+2,2*this.radius+2),t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.fillStyle=this.set?this.fillColor:"#0f0f0f",t.strokeStyle=this.set?"#95c299":"#330400",t.fill(),t.stroke(),t.closePath()},t}();i.VisualBit=e},607:(t,i,e)=>{Object.defineProperty(i,"__esModule",{value:!0}),i.ChangeBitSize=void 0;var s,n=e(115),r=e(116),a=(0,n.debounce)(c,200),o=(0,n.debounce)((function(t){t=Math.min(s.MaxBits,t),t=Math.max(2,t),document.getElementById("bits").value=t.toString(),h=t,c()}),200),h=8,u=2;function l(){s=new r.Environment(h,u)}function c(){if(null!=document.getElementById("viewport")){document.getElementById("viewport").remove();var t=s.BinaryNumbers,i=s.results;l(),s.results.setDecimal(i.getDecimal());for(var e=0;e<t.length;e++){var n=t[e].getBinary();n=n.substring(n.length-h),s.BinaryNumbers[e].setDecimal(parseInt(n,2))}}}l(),window.addEventListener("resize",(function(t){a()})),i.ChangeBitSize=function(t){o(t)}}},i={};!function e(s){var n=i[s];if(void 0!==n)return n.exports;var r=i[s]={exports:{}};return t[s](r,r.exports,e),r.exports}(607)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aXQvLi9zcmMvQmluYXJ5TnVtYmVyLnRzIiwid2VicGFjazovLzhiaXQvLi9zcmMvQ2FudmFzU3RhZ2UudHMiLCJ3ZWJwYWNrOi8vOGJpdC8uL3NyYy9EZWJvdW5jZVZhbHVlLnRzIiwid2VicGFjazovLzhiaXQvLi9zcmMvRW52aXJvbm1lbnQudHMiLCJ3ZWJwYWNrOi8vOGJpdC8uL3NyYy9NYXRoSGVscGVyLnRzIiwid2VicGFjazovLzhiaXQvLi9zcmMvVmlzdWFsQml0LnRzIiwid2VicGFjazovLzhiaXQvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vOGJpdC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly84Yml0L3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBraWxsIH0gZnJvbSBcInByb2Nlc3NcIjtcbmltcG9ydCB7IENoYW5nZUJpdFNpemUgfSBmcm9tIFwiLlwiO1xuaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tIFwiLi9FbnZpcm9ubWVudFwiO1xuaW1wb3J0IHsgVmlzdWFsQml0IH0gZnJvbSBcIi4vVmlzdWFsQml0XCI7XG5cbi8qKlxuICogTnVtYmVyIGNsYXNzIHJlcHJlc2VudHMgYSB2YWx1ZSAob25lIGNvbHVtbiksIGNvbnRhaW5pbmcgdGhlIGRlY2ltYWwgJiBiaW5hcnkgdmFsdWVcbiAqIEhvbGRzIHRoZSBhcnJheSBvZiBjaXJjbGVzIHVzZWQgdG8gdmlzdWFsbHkgcmVwcmVzZW50IHRoZSBiaW5hcnkgdmFsdWVcbiAqL1xuZXhwb3J0IGNsYXNzIEJpbmFyeU51bWJlciB7XG4gICAgcHJpdmF0ZSBiaXRzOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBkZWNpbWFsVmFsdWU6IG51bWJlcjtcbiAgICBwcml2YXRlIGJpbmFyeVZhbHVlOiBzdHJpbmc7XG4gICAgcHVibGljIFZpc3VhbEJpdHM6IFZpc3VhbEJpdFtdO1xuICAgIHByaXZhdGUgZW52OiBFbnZpcm9ubWVudDtcbiAgICBwcml2YXRlIHJvdzogbnVtYmVyO1xuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKGVudjogRW52aXJvbm1lbnQsIHJvdzogbnVtYmVyKTtcbiAgICBwdWJsaWMgY29uc3RydWN0b3IoZW52OiBFbnZpcm9ubWVudCwgcm93OiBudW1iZXIsIGRlY2ltYWxWYWx1ZT86IG51bWJlcikge1xuICAgICAgICB0aGlzLmVudiA9IGVudjtcbiAgICAgICAgdGhpcy5yb3cgPSByb3c7XG4gICAgICAgIHRoaXMuZGVjaW1hbFZhbHVlID0gZGVjaW1hbFZhbHVlID8/IDA7XG4gICAgICAgIHRoaXMuYmluYXJ5VmFsdWUgPSB0aGlzLmRlY2ltYWxWYWx1ZS50b1N0cmluZygyKTtcbiAgICAgICAgY29uc3QgbmV3Qml0cyA9IDIgKiBNYXRoLnJvdW5kKHRoaXMuYmluYXJ5VmFsdWUubGVuZ3RoIC8gMik7XG4gICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHMgPiB0aGlzLmVudi5jb2x1bW5zID8gbmV3Qml0cyA6IHRoaXMuZW52LmNvbHVtbnM7XG4gICAgICAgIHRoaXMuVmlzdWFsQml0cyA9IG5ldyBBcnJheSh0aGlzLmJpdHMpO1xuICAgICAgICB0aGlzLmNyZWF0ZVZpc3VhbEJpdHMoKTtcbiAgICAgICAgdGhpcy5zZXREZWNpbWFsKHRoaXMuZGVjaW1hbFZhbHVlKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldENpcmNsZVZhbHVlcygpIHtcbiAgICAgICAgbGV0IG92ZXJmbG93OiBib29sZWFuID0gZmFsc2U7XG4gICAgICAgIGxldCBiaW5hcnk6IHN0cmluZyA9IHRoaXMuYmluYXJ5VmFsdWU7XG5cbiAgICAgICAgaWYgKHRoaXMuVmlzdWFsQml0cy5sZW5ndGggPCBiaW5hcnkubGVuZ3RoKSB7XG4gICAgICAgICAgICBiaW5hcnkgPSBiaW5hcnkuc3Vic3RyaW5nKGJpbmFyeS5sZW5ndGgtdGhpcy5WaXN1YWxCaXRzLmxlbmd0aCk7XG4gICAgICAgICAgICBiaW5hcnkgPSB0aGlzLnNldENoYXJBdChiaW5hcnksMCxcIjFcIik7XG4gICAgICAgICAgICBvdmVyZmxvdyA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCBpID0gdGhpcy5WaXN1YWxCaXRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgICAgICB0aGlzLlZpc3VhbEJpdHNbaV0uc2V0T3ZlcmZsb3cob3ZlcmZsb3cpO1xuICAgICAgICAgICAgdGhpcy5WaXN1YWxCaXRzW2ldLnNldEJpdChiaW5hcnkuY2hhckF0KGkpID09IFwiMVwiID8gdHJ1ZSA6IGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlVmlzdWFsQml0cygpIHtcbiAgICAgICAgZm9yIChsZXQgYyA9IHRoaXMuYml0cy0xOyBjID49IDA7IGMtLSkge1xuICAgICAgICAgICAgdGhpcy5WaXN1YWxCaXRzW2NdPSB0aGlzLmFkZFZpc3VhbEJpdChjKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYWRkVmlzdWFsQml0KGNvbHVtbjogbnVtYmVyKSA6IFZpc3VhbEJpdCB7XG4gICAgICAgIHJldHVybiBuZXcgVmlzdWFsQml0KHRoaXMuZW52LnN0YXJ0WCArIGNvbHVtbiAqIHRoaXMuZW52LnNwYWNpbmcsIHRoaXMuZW52LnN0YXJ0WSArIHRoaXMuZW52LnJhZGl1cyArIHRoaXMuZW52LnNwYWNpbmcgKiB0aGlzLnJvdywgdGhpcy5lbnYucmFkaXVzLCB0aGlzLmVudik7XG4gICAgfVxuXG4gICAgcHVibGljIGdldERlY2ltYWwoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGVjaW1hbFZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRCaW5hcnkoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJ5VmFsdWU7XG4gICAgfVxuXG4gICAgcHVibGljIHNldEJpdChpbmRleDogbnVtYmVyLCBib29sPzogYm9vbGVhbikge1xuICAgICAgICBib29sID0gYm9vbCA/PyAhdGhpcy5WaXN1YWxCaXRzW2luZGV4XS5zZXQ7XG4gICAgICAgIHRoaXMuYmluYXJ5VmFsdWUgPSB0aGlzLnNldENoYXJBdCh0aGlzLmJpbmFyeVZhbHVlLGluZGV4LCBib29sID8gXCIxXCI6XCIwXCIpO1xuICAgICAgICB0aGlzLlZpc3VhbEJpdHNbaW5kZXhdLnNldEJpdChib29sKTtcbiAgICAgICAgdGhpcy5kZWNpbWFsVmFsdWUgPSBwYXJzZUludCh0aGlzLmJpbmFyeVZhbHVlLCAyKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHVwZGF0ZUJpbmFyeVN0cmluZygpIHtcbiAgICAgICAgdGhpcy5iaW5hcnlWYWx1ZSA9IHRoaXMuZGVjaW1hbFZhbHVlLnRvU3RyaW5nKDIpO1xuICAgICAgICBpZiAodGhpcy5iaW5hcnlWYWx1ZS5sZW5ndGggPCB0aGlzLmVudi5jb2x1bW5zKSB0aGlzLmJpbmFyeVZhbHVlID0gdGhpcy5iaW5hcnlWYWx1ZS5wYWRTdGFydCh0aGlzLmVudi5jb2x1bW5zLFwiMFwiKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0RGVjaW1hbChkZWNpbWFsVmFsdWUgOiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5kZWNpbWFsVmFsdWUgPSBkZWNpbWFsVmFsdWU7XG4gICAgICAgIHRoaXMudXBkYXRlQmluYXJ5U3RyaW5nKCk7XG4gICAgICAgIHRoaXMuc2V0Q2lyY2xlVmFsdWVzKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRDaGFyQXQoc3RyOiBzdHJpbmcsaW5kZXg6IG51bWJlcixjaHI6IHN0cmluZykge1xuICAgICAgICBpZihpbmRleCA+IHN0ci5sZW5ndGgtMSkgcmV0dXJuIHN0cjtcbiAgICAgICAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoMCxpbmRleCkgKyBjaHIgKyBzdHIuc3Vic3RyaW5nKGluZGV4KzEpO1xuICAgIH1cbn1cblxuIiwiaW1wb3J0IHsgc3RhcnQgfSBmcm9tIFwicmVwbFwiO1xuaW1wb3J0IHsgQ2hhbmdlQml0U2l6ZSB9IGZyb20gXCIuXCI7XG5pbXBvcnQgeyBFbnZpcm9ubWVudCB9IGZyb20gXCIuL0Vudmlyb25tZW50XCI7XG5pbXBvcnQgeyBDb21wdXRlIH0gZnJvbSBcIi4vTWF0aEhlbHBlclwiO1xuXG4vKipcbiAqIEludGVyZmFjZSB0byBob2xkIGNvb3JkaW5hdGVzIGZvciBhIG1vdXNlIGNsaWNrIGV2ZW50XG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgbW91c2VDbGljayB7XG4gICAgeDogbnVtYmVyO1xuICAgIHk6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIENhbnZhc1N0YWdlIHtcbiAgICAvKipcbiAgICAgKiBDb250YWlucyBpbmZvIGFib3V0IHRoZSBjYW52YXMgRE9NIG9iamVjdFxuICAgICAqL1xuICAgIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQ7XG4gICAgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xuICAgIGVudmlyb25tZW50OiBFbnZpcm9ubWVudDtcblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBjYW52YXMgdG8gZHJhdyBvbiwgaGFuZGxpbmcgaW5wdXRcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gZW52aXJvbm1lbnQgLSBUaGUgRW52aXJvbm1lbnQgY2xhc3MgdGhhdCBjcmVhdGVkIHRoaXMgY2FudmFzXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoZW52aXJvbm1lbnQ6IEVudmlyb25tZW50KSB7XG4gICAgICAgIHRoaXMuZW52aXJvbm1lbnQgPSBlbnZpcm9ubWVudDtcblxuICAgICAgICAvLyBTZXQgYmFja2dyb3VuZCBjb2xvciB0byBibGFja1xuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmJhY2tncm91bmRDb2xvciA9IFwiYmxhY2tcIjtcblxuICAgICAgICAvLyBDcmVhdGUgY2FudmFzIGFuZCBhcHBlbmQgdG8gcGFnZSwgd2l0aCBlcnJvciBoYW5kbGluZ1xuICAgICAgICBpZiAoISh0aGlzLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIikgYXMgSFRNTENhbnZhc0VsZW1lbnQpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gY3JlYXRlIGNhbnZhc1wiKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBTZXQgSUQgb2YgdGhlIGNhbnZhcywgZm9yIENTUyBzdHlsaW5nXG4gICAgICAgIHRoaXMuY2FudmFzLmlkID0gXCJ2aWV3cG9ydFwiO1xuICAgICAgICBcbiAgICAgICAgLy8gQXBwZW5kIHRoZSBjYW52YXMgdG8gdGhlIGNvbnRhaW5lciBkaXYsIHdpdGggZXJyb3IgaGFuZGxpbmdcbiAgICAgICAgbGV0IGNvbnRhaW5lckRpdjogSFRNTEVsZW1lbnQ7XG4gICAgICAgIGlmICghKGNvbnRhaW5lckRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFpblwiKSEpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gYXBwZW5kIGNhbnZhcyB0byBjb250YWluZXJcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29udGFpbmVyRGl2LmFwcGVuZCh0aGlzLmNhbnZhcykhXG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgY29udGV4dCwgd2l0aCBlcnJvciBoYW5kbGluZ1xuICAgICAgICBpZiAoISh0aGlzLmNvbnRleHQgPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIikhKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiMmQgY29udGV4dCBub3Qgc3VwcG9ydGVkIG9yIGNhbnZhcyBhbHJlYWR5IGluaXRpYWxpemVkXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9BZGQgaW5wdXQgZXZlbnQgaGFuZGxpbmdcbiAgICAgICAgbGV0IGNsYXNzQWNjZXNzb3IgPSB0aGlzO1xuICAgICAgICB0aGlzLmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBmdW5jdGlvbihlKVxuICAgICAgICB7XG4gICAgICAgICAgICBjbGFzc0FjY2Vzc29yLm1vdXNlQ2xpY2tFdmVudChlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21wdXRlXCIpPy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIixmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICBDb21wdXRlKGNsYXNzQWNjZXNzb3IuZW52aXJvbm1lbnQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgYml0c0lucHV0IDogSFRNTElucHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYml0c1wiKSEgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgaWYgKGJpdHNJbnB1dCkge1xuICAgICAgICAgICAgYml0c0lucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBsZXQgdmFsdWU6IG51bWJlcjtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPSBwYXJzZUludChiaXRzSW5wdXQudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIENoYW5nZUJpdFNpemUodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSBlbnZpcm9ubWVudC53aWR0aDtcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gZW52aXJvbm1lbnQuaGVpZ2h0O1xuXG4gICAgICAgIHRoaXMuZHJhd0xpbmUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gZXZlbnQgLSBNb3VzZSBjbGljayBldmVudFxuICAgICAqIEByZXR1cm5zIC0gQ29vcmRpbmF0ZXMgYXMgbW91c2VDbGljayBpbnRlcmZhY2VcbiAgICAgKi9cbiAgICBnZXRNb3VzZVBvc2l0aW9uKGV2ZW50OiBNb3VzZUV2ZW50KSA6IG1vdXNlQ2xpY2sge1xuICAgICAgICBsZXQgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCAvLyBhYnMuIHNpemUgb2YgZWxlbWVudFxuICAgICAgICBzY2FsZVggPSB0aGlzLmNhbnZhcy53aWR0aCAvIHJlY3Qud2lkdGgsICAgIC8vIHJlbGF0aW9uc2hpcCBiaXRtYXAgdnMuIGVsZW1lbnQgZm9yIHhcbiAgICAgICAgc2NhbGVZID0gdGhpcy5jYW52YXMuaGVpZ2h0IC8gcmVjdC5oZWlnaHQ7ICAvLyByZWxhdGlvbnNoaXAgYml0bWFwIHZzLiBlbGVtZW50IGZvciB5XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IChldmVudC5jbGllbnRYIC0gcmVjdC5sZWZ0KSAqIHNjYWxlWCwgICAvLyBzY2FsZSBtb3VzZSBjb29yZGluYXRlcyBhZnRlciB0aGV5IGhhdmVcbiAgICAgICAgICAgIHk6IChldmVudC5jbGllbnRZIC0gcmVjdC50b3ApICogc2NhbGVZICAgICAvLyBiZWVuIGFkanVzdGVkIHRvIGJlIHJlbGF0aXZlIHRvIGVsZW1lbnRcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGVjdHMgd2hpY2ggY2lyY2xlIHdhcyBjbGlja2VkIG9uLCBhbmQgc3dpdGNoZXMgdGhhdCBiaXRcbiAgICAgKiBcbiAgICAgKiBAcGFyYW0gZSAtIFRyaWdnZXJpbmcgZXZlbnRcbiAgICAgKiBAcGFyYW0gY2FudmFzIC0gQ2FudmFzIGNsYXNzIHRoYXQgaXMgY3VycmVudGx5IGJlaW5nIHVzZWRcbiAgICAgKi9cbiAgICBtb3VzZUNsaWNrRXZlbnQoZTpNb3VzZUV2ZW50KSB7XG4gICAgICAgIGxldCBtb3VzZVBvcyA6IG1vdXNlQ2xpY2sgPSB0aGlzLmdldE1vdXNlUG9zaXRpb24oZSk7XG4gICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IHRoaXMuZW52aXJvbm1lbnQucm93czsgcm93KyspIHtcbiAgICAgICAgICAgIGNvbnN0IHNwYWNpbmcgPSB0aGlzLmVudmlyb25tZW50LnNwYWNpbmc7XG4gICAgICAgICAgICBjb25zdCBzdGFydFkgPSB0aGlzLmVudmlyb25tZW50LnN0YXJ0WTtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0WCA9IHRoaXMuZW52aXJvbm1lbnQuc3RhcnRYO1xuICAgICAgICAgICAgY29uc3QgcmFkaXVzID0gdGhpcy5lbnZpcm9ubWVudC5yYWRpdXM7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICgobW91c2VQb3MueSA+IHN0YXJ0WStyb3cqc3BhY2luZyAmJiBtb3VzZVBvcy55IDwgKHN0YXJ0WStyb3cqc3BhY2luZykrc3BhY2luZykpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCB0aGlzLmVudmlyb25tZW50LmNvbHVtbnM7IGNvbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICgobW91c2VQb3MueCA+IHN0YXJ0WCArIChjb2wqc3BhY2luZy1yYWRpdXMpKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgKG1vdXNlUG9zLnggPCBzdGFydFggKyAoY29sKnNwYWNpbmcrcmFkaXVzKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVudmlyb25tZW50LkJpbmFyeU51bWJlcnNbcm93XS5zZXRCaXQoY29sKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERyYXdzIHRoZSBkaXZpZGVyIGxpbmUgYmV0d2VlbiB0aGUgbnVtYmVycyBhbmQgcmVzdWx0cyBkaXNwbGF5XG4gICAgICovXG4gICAgZHJhd0xpbmUoKSB7XG4gICAgICAgIHRoaXMuY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICAgICAgY29uc3QgeVBvcyA6IG51bWJlciA9IHRoaXMuZW52aXJvbm1lbnQuc3RhcnRZK3RoaXMuZW52aXJvbm1lbnQuc3BhY2luZy80K3RoaXMuZW52aXJvbm1lbnQucm93cyp0aGlzLmVudmlyb25tZW50LnNwYWNpbmc7XG4gICAgICAgIGNvbnN0IHhQb3MgOiBudW1iZXIgPSB0aGlzLmVudmlyb25tZW50LnN0YXJ0WCAtIHRoaXMuZW52aXJvbm1lbnQucmFkaXVzO1xuICAgICAgICB0aGlzLmNvbnRleHQubW92ZVRvKHhQb3MsIHlQb3MpO1xuICAgICAgICB0aGlzLmNvbnRleHQubGluZVRvKHhQb3MgKyB0aGlzLmVudmlyb25tZW50LmNvbHVtbnMqdGhpcy5lbnZpcm9ubWVudC5zcGFjaW5nLCAgeVBvcyk7XG4gICAgICAgIHRoaXMuY29udGV4dC5zdHJva2VTdHlsZSA9IFwid2hpdGVcIjtcbiAgICAgICAgdGhpcy5jb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICB0aGlzLmNvbnRleHQuY2xvc2VQYXRoKCk7XG4gICAgfVxuXG4gICAgZHJhd0J1dHRvbnMoKSB7XG5cbiAgICB9XG59XG5cbiIsIi8qKlxuICogSW52b2tlcyB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gYWZ0ZXIgYSB3YWl0IHRpbWUgYmVnaW5uaW5nIGFmdGVyIHRoZSByZXR1cm4gZnVuY3Rpb24gc3RvcHMgYmVpbmcgY2FsbGVkLlxuICogXG4gKiBAcGFyYW0gY2FsbGJhY2sgLSBGdW5jdGlvbiB0byBjYWxsIHdoZW4gZG9uZSBkZWJvdW5jaW5nXG4gKiBAcGFyYW0gd2FpdCAtIFdhaXQgdGltZVxuICogQHJldHVybnMgLSBGdW5jdGlvbiB0byBiZSBjYWxsZWQgKHJlcGVhdGVkbHkpIGJ5IHRoZSBhY3Rpb24gdG8gYmUgZGVib3VuY2VkICh3aW5kb3cgcmVzaXplLCBldGMpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWJvdW5jZTxUIGV4dGVuZHMgdW5rbm93bltdLCBVPihcbiAgICBjYWxsYmFjazogKC4uLmFyZ3M6IFQpID0+IFByb21pc2VMaWtlPFU+IHwgVSxcbiAgICB3YWl0OiBudW1iZXJcbiAgKSB7XG4gICAgbGV0IHN0YXRlOlxuICAgICAgfCB1bmRlZmluZWRcbiAgICAgIHwge1xuICAgICAgICAgIHRpbWVvdXQ6IFJldHVyblR5cGU8dHlwZW9mIHNldFRpbWVvdXQ+XG4gICAgICAgICAgcHJvbWlzZTogUHJvbWlzZTxVPlxuICAgICAgICAgIHJlc29sdmU6ICh2YWx1ZTogVSB8IFByb21pc2VMaWtlPFU+KSA9PiB2b2lkXG4gICAgICAgICAgcmVqZWN0OiAodmFsdWU6IGFueSkgPT4gdm9pZFxuICAgICAgICAgIGxhdGVzdEFyZ3M6IFRcbiAgICAgICAgfSA9IHVuZGVmaW5lZFxuICBcbiAgICByZXR1cm4gKC4uLmFyZ3M6IFQpOiBQcm9taXNlPFU+ID0+IHtcbiAgICAgIGlmICghc3RhdGUpIHtcbiAgICAgICAgc3RhdGUgPSB7fSBhcyBhbnlcbiAgICAgICAgc3RhdGUhLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgc3RhdGUhLnJlc29sdmUgPSByZXNvbHZlXG4gICAgICAgICAgc3RhdGUhLnJlamVjdCA9IHJlamVjdFxuICAgICAgICB9KVxuICAgICAgfVxuICAgICAgY2xlYXJUaW1lb3V0KHN0YXRlIS50aW1lb3V0KVxuICAgICAgc3RhdGUhLmxhdGVzdEFyZ3MgPSBhcmdzXG4gICAgICBzdGF0ZSEudGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBjb25zdCBzID0gc3RhdGUhXG4gICAgICAgIHN0YXRlID0gdW5kZWZpbmVkXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcy5yZXNvbHZlKGNhbGxiYWNrKC4uLnMubGF0ZXN0QXJncykpXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBzLnJlamVjdChlKVxuICAgICAgICB9XG4gICAgICB9LCB3YWl0KVxuICBcbiAgICAgIHJldHVybiBzdGF0ZSEucHJvbWlzZVxuICAgIH1cbiAgfSIsImltcG9ydCB7IFZpc3VhbEJpdCB9IGZyb20gXCIuL1Zpc3VhbEJpdFwiO1xuaW1wb3J0IHsgQ2FudmFzU3RhZ2UgfSBmcm9tIFwiLi9DYW52YXNTdGFnZVwiO1xuaW1wb3J0IHsgQmluYXJ5TnVtYmVyIH0gZnJvbSBcIi4vQmluYXJ5TnVtYmVyXCI7XG5cbmV4cG9ydCBjbGFzcyBFbnZpcm9ubWVudCB7XG4gICAgLyoqXG4gICAgICogQ29udGFpbnMgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHZpc3VhbCBjYWxjdWxhdG9yXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBBbiBhcnJheSwgZmlyc3QgZGltZW5zaW9uIGlzIHRoZSByb3cgKG51bWJlciksIHNlY29uZCBkaW1lbnNpb24gaXMgdGhlIGNvbHVtbiAoYml0KVxuICAgICAqL1xuICAgIGNpcmNsZXM6VmlzdWFsQml0W11bXTtcblxuICAgIC8qKlxuICAgICAqIE51bWJlciBjbGFzcyBhcnJheSwgZWFjaCBOdW1iZXIgaG9sZHMgYSByb3cgKG51bWJlcilcbiAgICAgKi9cbiAgICBCaW5hcnlOdW1iZXJzOkJpbmFyeU51bWJlcltdO1xuXG4gICAgLyoqXG4gICAgICogQSBCaW5hcnlOdW1iZXIgdG8gZGlzcGxheSB0aGUgcmVzdWx0c1xuICAgICAqL1xuICAgIHJlc3VsdHM6QmluYXJ5TnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogUmFkaXVzIG9mIHRoZSBjaXJjbGUsIGNvbXB1dGVkIGJhc2VkIG9uIHdpbmRvdyB3aWR0aFxuICAgICAqL1xuICAgIHJhZGl1czpudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBTdGFydGluZyBwb3NpdGlvbiB0byBkcmF3IGNvbHVtbnNcbiAgICAgKi9cbiAgICBzdGFydFg6bnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogU3RhcnRpbmcgcG9zaXRpb24gdG8gZHJhdyByb3dzXG4gICAgICovXG4gICAgc3RhcnRZOm51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIE51bWJlciBvZiBiaXRzIChjb2x1bW5zKSBwZXIgbnVtYmVyXG4gICAgICovXG4gICAgY29sdW1uczpudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBOdW1iZXIgb2YgbnVtYmVycyAocm93cylcbiAgICAgKi9cbiAgICByb3dzOm51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFNwYWNpbmcgaXMgdGhlIHRvdGFsIHNwYWNlIHRoYXQgZWFjaCBjaXJjbGUgdGFrZXMgdXAgd2l0aCBwYWRkaW5nXG4gICAgICovXG4gICAgc3BhY2luZzpudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgY2FudmFzIHRvIGRyYXcgb25cbiAgICAgKi9cbiAgICBjYW52YXM6Q2FudmFzU3RhZ2U7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgd2lkdGggb2YgdGhlIGNhbnZhc1xuICAgICAqL1xuICAgIHdpZHRoOm51bWJlcjtcblxuICAgIC8qKlxuICAgICAqIFRoZSBoZWlnaHQgb2YgdGhlIGNhbnZhc1xuICAgICAqL1xuICAgIGhlaWdodDpudW1iZXI7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgcGFkZGluZyBzdXJyb3VuZGluZyB0aGUgZHJhdyBhcmVhXG4gICAgICovXG4gICAgcGFnZVBhZGRpbmc6bnVtYmVyID0gMTA7XG5cbiAgICAvKipcbiAgICAgKiBNaW5pbXVtIHJhZGl1cyBvZiBjaXJjbGUgaW4gcGl4ZWxzXG4gICAgICovXG4gICAgbWluV2lkdGg6bnVtYmVyID0gMTA7XG5cbiAgICAvKipcbiAgICAgKiBNYXhpbXVtIGJpdHMgdGhlIHBhZ2UgY2FuIGZpdFxuICAgICAqL1xuICAgIE1heEJpdHM6bnVtYmVyO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGNhbnZhcyBhbmQgZHJhd3MgY2lyY2xlcyBvbiBpdCB0byByZXByZXNlbnQgKHJvdykgYmluYXJ5IG51bWJlcnMgb2YgKGNvbHVtbnMpIGJpdCBsZW5ndGguXG4gICAgICogQHBhcmFtIGNvbHVtbnMgLSBOdW1iZXIgb2YgY29sdW1ucyAoYml0cylcbiAgICAgKiBAcGFyYW0gcm93cyAtIE51bWJlciBvZiByb3dzIChudW1iZXJzKVxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGNvbHVtbnM6bnVtYmVyLHJvd3M6bnVtYmVyKSB7XG4gICAgICAgIHRoaXMuY29sdW1ucyA9IGNvbHVtbnM7XG4gICAgICAgIHRoaXMucm93cyA9IHJvd3M7XG4gICAgICAgIGxldCBwYWRkaW5nOiBudW1iZXIgPSA1O1xuXG4gICAgICAgIC8vRGV0ZXJtaW5lIHRoZSBkcmF3aW5nIGFyZWEgc2l6ZVxuICAgICAgICB0aGlzLndpZHRoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYWluXCIpIS5vZmZzZXRXaWR0aC10aGlzLnBhZ2VQYWRkaW5nKjI7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYWluXCIpIS5vZmZzZXRIZWlnaHQtdGhpcy5wYWdlUGFkZGluZyoyO1xuICAgICAgICBcblxuICAgICAgICAvL01heGltdW0gY29sdW1ucyB3ZSBjb3VsZCBoYXZlIHdpdGggdGhlIG1pbldpZHRoXG4gICAgICAgIHRoaXMuTWF4Qml0cyA9ICBNYXRoLmZsb29yKCh0aGlzLndpZHRoKSAvICgodGhpcy5taW5XaWR0aCoyKStwYWRkaW5nKSk7XG4gICAgICAgIHRoaXMuY29sdW1ucyA9IE1hdGgubWF4KE1hdGgubWluKHRoaXMuTWF4Qml0cywgdGhpcy5jb2x1bW5zKSwyKTtcbiAgICAgICAgbGV0IGJpdElucHV0IDogSFRNTElucHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYml0c1wiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICBiaXRJbnB1dC52YWx1ZSA9IHRoaXMuY29sdW1ucy50b1N0cmluZygpO1xuXG4gICAgICAgIC8vIENvbXB1dGUgdGhlIG1heGltdW0gcmFkaXVzIHRoYXQgYWxsb3dzIGFsbCB0aGUgY2lyY2xlcyB0byBmaXQgb24gdGhlIHBhZ2VcbiAgICAgICAgdGhpcy5yYWRpdXMgPSBNYXRoLm1heChcbiAgICAgICAgICAgIHRoaXMubWluV2lkdGgsXG4gICAgICAgICAgICBNYXRoLmZsb29yKFxuICAgICAgICAgICAgICAgIE1hdGgubWluKFxuICAgICAgICAgICAgICAgICAgICAoKCh0aGlzLndpZHRoKSAtIHBhZGRpbmcqdGhpcy5jb2x1bW5zKS8yKSAvIHRoaXMuY29sdW1ucyxcbiAgICAgICAgICAgICAgICAgICAgKCgodGhpcy5oZWlnaHQpIC0gKHBhZGRpbmcqKHRoaXMucm93cysyKSkpLzIpIC8gKHRoaXMucm93cysyKVxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICAvL1RoZSBzcGFjZSBiZXR3ZWVuIGVhY2ggY2lyY2xlXG4gICAgICAgIHRoaXMuc3BhY2luZyA9IHRoaXMucmFkaXVzICogMiArIHBhZGRpbmc7XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBzdGFydGluZyBwb3NpdGlvbiB0byBkcmF3IHRoZSBjaXJjbGVzXG4gICAgICAgIGxldCB0b3RhbFdpZHRoID0gdGhpcy5jb2x1bW5zICogdGhpcy5zcGFjaW5nIC0gcGFkZGluZyoyO1xuICAgICAgICBsZXQgc3RhcnRYID0gKHRoaXMud2lkdGggLSB0b3RhbFdpZHRoKSAvIDIgKyB0aGlzLnJhZGl1cztcbiAgICAgICAgbGV0IHRvdGFsSGVpZ2h0ID0gKCh0aGlzLnJvd3MrMikgKiB0aGlzLnNwYWNpbmcpO1xuICAgICAgICBsZXQgc3RhcnRZID0gKHRoaXMuaGVpZ2h0IC0gdG90YWxIZWlnaHQpIC8gMjtcblxuICAgICAgICB0aGlzLnN0YXJ0WCA9IHN0YXJ0WDtcbiAgICAgICAgdGhpcy5zdGFydFkgPSBzdGFydFk7XG5cbiAgICAgICAgLy8gSW5pdCBjaXJjbGUgYXJyYXlcbiAgICAgICAgdGhpcy5jaXJjbGVzID0gbmV3IEFycmF5KHRoaXMucm93cyk7XG4gICAgICAgIHRoaXMuQmluYXJ5TnVtYmVycyA9IG5ldyBBcnJheSh0aGlzLnJvd3MpO1xuXG4gICAgICAgIC8vIENyZWF0ZSBjYW52YXMgdG8gZHJhdyBvblxuICAgICAgICB0aGlzLmNhbnZhcyA9IG5ldyBDYW52YXNTdGFnZSh0aGlzKTtcbiAgICAgICAgdGhpcy5yZXN1bHRzID0gbmV3IEJpbmFyeU51bWJlcih0aGlzLHRoaXMucm93cysxKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENyZWF0ZXMgdGhlIGNpcmNsZXMgZm9yIGVhY2ggcm93IChudW1iZXIpIHdpdGggdGhlIGFtb3VudCBvZiBiaXRzIChjb2x1bW5zKSByZXF1ZXN0ZWQuXG4gICAgICAgIGZvciAobGV0IHIgPSAwOyByIDwgdGhpcy5yb3dzOyByKyspIHtcbiAgICAgICAgICAgIHRoaXMuQmluYXJ5TnVtYmVyc1tyXSA9IG5ldyBCaW5hcnlOdW1iZXIodGhpcyxyKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IENoYW5nZUJpdFNpemUgfSBmcm9tIFwiLlwiO1xuaW1wb3J0IHsgQmluYXJ5TnVtYmVyIH0gZnJvbSBcIi4vQmluYXJ5TnVtYmVyXCI7XG5pbXBvcnQgeyBFbnZpcm9ubWVudCB9IGZyb20gXCIuL0Vudmlyb25tZW50XCI7XG5cbi8qKlxuICogQ29udmVydHMgYmluYXJ5IHJlcHJlc2VudGF0aW9uIHRvIGRlY2ltYWwsIHBlcmZvcm1zIHRoZSBkZXNpcmVkIG1hdGggZnVuY3Rpb24sIHRoZW4gZGlzcGxheXMgdGhlIHJlc3VsdHMgaW4gYmluYXJ5XG4gKiBAcGFyYW0gZW52IC0gRW52aXJvbm1lbnQgdXNlZCB0byBjb21wdXRlIHZhbHVlc1xuICogXG4gKiBUT0RPOiBBbGxvdyBjaG9vc2luZyBvZiBvcGVyYW5kIChhZGQsc3VidHJhY3QsbXVsdGlwbHksZGl2aWRlKVxuICovXG5leHBvcnQgZnVuY3Rpb24gQ29tcHV0ZShlbnY6IEVudmlyb25tZW50KTogdm9pZCB7XG5cbiAgICBsZXQgcmVzdWx0czpudW1iZXIgPSAwO1xuICAgIGZvciAobGV0IHIgPSAwOyByIDwgZW52LnJvd3M7IHIrKykge1xuICAgICAgICByZXN1bHRzICs9IGVudi5CaW5hcnlOdW1iZXJzW3JdLmdldERlY2ltYWwoKTtcbiAgICB9XG4gICAgZW52LnJlc3VsdHMuc2V0RGVjaW1hbChyZXN1bHRzKTtcbn0iLCJpbXBvcnQgeyBFbnZpcm9ubWVudCB9IGZyb20gXCIuL0Vudmlyb25tZW50XCI7XG5cbmV4cG9ydCBjbGFzcyBWaXN1YWxCaXQge1xuICAgIC8qKlxuICAgICAqIENsYXNzIHRoYXQgaG9sZHMgaW5mbyBhYm91dCBhIGNpcmNsZSBkcmF3biBvbiBhbiBIVE1MIGNhbnZhcywgcmVwcmVzZW50aW5nIGEgdmlzdWFsIGJpdCBvZiBkYXRhLlxuICAgICAqL1xuXG4gICAgc2V0OkJvb2xlYW47XG4gICAgeDpudW1iZXI7XG4gICAgeTpudW1iZXI7XG4gICAgcmFkaXVzOm51bWJlcjtcbiAgICBsZWZ0OiBudW1iZXI7XG4gICAgdG9wOiBudW1iZXI7XG4gICAgcmlnaHQ6IG51bWJlcjtcbiAgICBib3R0b206IG51bWJlcjtcbiAgICBlbnY6IEVudmlyb25tZW50O1xuICAgIGZpbGxDb2xvcjogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogXG4gICAgICogQHBhcmFtIHggQ2VudGVycG9pbnQgWCBjb29yZGluYXRlIHRvIGRyYXcgY2lyY2xlXG4gICAgICogQHBhcmFtIHkgQ2VudGVycG9pbnQgWSBjb29yZGluYXRlIHRvIGRyYXcgY2lyY2xlXG4gICAgICogQHBhcmFtIHJhZGl1cyBSYWRpdXMgb2YgY2lyY2xlIHRvIGRyYXdcbiAgICAgKiBAcGFyYW0gZW52IENhbnZhcyBjb250ZXh0IHRvIGRyYXcgb25cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih4IDogbnVtYmVyLCB5OiBudW1iZXIsIHJhZGl1czpudW1iZXIsIGVudjogRW52aXJvbm1lbnQpXG4gICAgY29uc3RydWN0b3IoeCA6IG51bWJlciwgeTogbnVtYmVyLCByYWRpdXM6bnVtYmVyLCBlbnY6IEVudmlyb25tZW50LCBzZXQ/OkJvb2xlYW4pIHtcbiAgICAgICAgdGhpcy54ID0geDtcbiAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgdGhpcy5zZXQgPSBzZXQgPz8gZmFsc2U7XG4gICAgICAgIHRoaXMucmFkaXVzID0gcmFkaXVzO1xuICAgICAgICB0aGlzLmxlZnQgPSB0aGlzLngtcmFkaXVzLTE7XG4gICAgICAgIHRoaXMudG9wID0gdGhpcy55LXJhZGl1cy0xO1xuICAgICAgICB0aGlzLnJpZ2h0ID0gdGhpcy54K3JhZGl1cysxO1xuICAgICAgICB0aGlzLmJvdHRvbSA9IHRoaXMueStyYWRpdXMrMTtcbiAgICAgICAgdGhpcy5lbnYgPSBlbnY7XG4gICAgICAgIHRoaXMuZmlsbENvbG9yID0gXCJ3aGl0ZVwiO1xuICAgICAgICB0aGlzLmRyYXcoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTd2l0Y2hlcyB0aGUgYml0IHZhbHVlIGFuZCByZWRyYXdcbiAgICAgKi9cbiAgICBzd2l0Y2hCaXQoKSB7XG4gICAgICAgIHRoaXMuc2V0ID0gIXRoaXMuc2V0O1xuICAgICAgICB0aGlzLmRyYXcoKTtcbiAgICAgICAgXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgYml0IHZhbHVlIGZvciB0aGUgY2lyY2xlIHRvIHRoZSBwcm92aWRlZCBiaXQgYW5kIHJlZHJhd1xuICAgICAqIEBwYXJhbSBiaXQgLSBTZXR0aW5nIHRvIGFwcGx5IHRvIHRoZSBiaXRcbiAgICAgKi9cbiAgICBzZXRCaXQoYml0OiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMuc2V0ID0gYml0O1xuICAgICAgICB0aGlzLmRyYXcoKTtcbiAgICB9XG5cbiAgICBzZXRPdmVyZmxvdyhvdmVyZmxvdzogYm9vbGVhbikge1xuICAgICAgICBpZihvdmVyZmxvdykgdGhpcy5maWxsQ29sb3IgPSBcInJlZFwiOyBcbiAgICAgICAgZWxzZSB0aGlzLmZpbGxDb2xvciA9IFwid2hpdGVcIjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEcmF3cyB0aGUgY2lyY2xlXG4gICAgICogQHBhcmFtIGNvbnRleHQgLSBUaGUgY2FudmFzIGNvbnRleHQgdG8gZHJhdyBvblxuICAgICAqL1xuICAgIGRyYXcoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCA9IHRoaXMuZW52LmNhbnZhcy5jb250ZXh0O1xuICAgICAgICBjb250ZXh0LmNsZWFyUmVjdCh0aGlzLmxlZnQsIHRoaXMudG9wLCB0aGlzLnJhZGl1cyoyKzIsIHRoaXMucmFkaXVzKjIrMik7XG4gICAgICAgIGNvbnRleHQuYmVnaW5QYXRoKCk7XG4gICAgICAgIGNvbnRleHQuYXJjKHRoaXMueCwgdGhpcy55LCB0aGlzLnJhZGl1cywgMCwgMiAqIE1hdGguUEkpO1xuICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IHRoaXMuc2V0ID8gdGhpcy5maWxsQ29sb3IgOiBcIiMwZjBmMGZcIjtcbiAgICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IHRoaXMuc2V0ID8gXCIjOTVjMjk5XCIgOiBcIiMzMzA0MDBcIiA7XG4gICAgICAgIGNvbnRleHQuZmlsbCgpO1xuICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgICAgICBjb250ZXh0LmNsb3NlUGF0aCgpO1xuICAgIH1cbn0iLCJpbXBvcnQgeyBCaW5hcnlOdW1iZXIgfSBmcm9tIFwiLi9CaW5hcnlOdW1iZXJcIjtcbmltcG9ydCB7IGRlYm91bmNlIH0gZnJvbSBcIi4vRGVib3VuY2VWYWx1ZVwiO1xuaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tIFwiLi9FbnZpcm9ubWVudFwiO1xuXG5sZXQgZW52OiBFbnZpcm9ubWVudDtcbmxldCBkZWJvdW5jZVdpbmRvd1Jlc2l6ZSA9IGRlYm91bmNlKERlbGV0ZUNhbnZhcywgMjAwKTtcbmxldCBkZWJvdW5jZUJpdFJlc2l6ZSA9IGRlYm91bmNlKGNoYW5nZUJpdHMsIDIwMCk7XG5sZXQgY29sdW1uczogbnVtYmVyID0gODtcbmxldCByb3dzOiBudW1iZXIgPSAyO1xuXG5DcmVhdGUoKTtcblxuLyoqXG4gKiBIYW5kbGVzIHRoZSBjcmVhdGlvbiBvZiB0aGUgRW52aXJvbm1lbnQuIEFkZHMgYSBoYW5kbGVyIHRvIHRoZSB3aW5kb3cgdGhhdCB3aWxsIHJlY3JlYXRlIHRoZSBFbnZpcm9ubWVudCB3aGVuZXZlciB0aGUgd2luZG93IGlzIHJlc2l6ZWQuXG4gKi9cbmZ1bmN0aW9uIENyZWF0ZSgpIHtcbiAgICBDcmVhdGVFbnZpcm9ubWVudCgpO1xuXG4gICAgLy8gRGVib3VuY2VkIHdpbmRvdyByZXNpemUgaW5wdXQgaGFuZGxlclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgZGVib3VuY2VXaW5kb3dSZXNpemUoKTtcbiAgICB9KTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IEVudmlyb25tZW50XG4gKi9cbmZ1bmN0aW9uIENyZWF0ZUVudmlyb25tZW50KCk6IHZvaWQge1xuICAgIGVudiA9IG5ldyBFbnZpcm9ubWVudChjb2x1bW5zLHJvd3MpO1xufVxuXG4vKipcbiAqIERlbGV0ZXMgdGhlIENhbnZhcywgYW5kIGNyZWF0ZXMgYSBuZXcgRW52aXJvbm1lbnRcbiAqL1xuZnVuY3Rpb24gRGVsZXRlQ2FudmFzKCl7XG4gICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidmlld3BvcnRcIikgIT0gbnVsbCkge1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInZpZXdwb3J0XCIpIS5yZW1vdmUoKTtcblxuICAgICAgICBjb25zdCBzdG9yZU51bWJlcnM6IEJpbmFyeU51bWJlcltdID0gZW52LkJpbmFyeU51bWJlcnM7XG4gICAgICAgIGNvbnN0IHJlc3VsdE51bWJlcjogQmluYXJ5TnVtYmVyID0gZW52LnJlc3VsdHM7XG5cbiAgICAgICAgQ3JlYXRlRW52aXJvbm1lbnQoKTtcblxuICAgICAgICBlbnYucmVzdWx0cy5zZXREZWNpbWFsKHJlc3VsdE51bWJlci5nZXREZWNpbWFsKCkpO1xuICAgICAgICBcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdG9yZU51bWJlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBsZXQgYmluYXJ5VmFsdWUgPSBzdG9yZU51bWJlcnNbaV0uZ2V0QmluYXJ5KCk7XG4gICAgICAgICAgICAgICAgYmluYXJ5VmFsdWUgPSBiaW5hcnlWYWx1ZS5zdWJzdHJpbmcoYmluYXJ5VmFsdWUubGVuZ3RoLWNvbHVtbnMpO1xuICAgICAgICAgICAgICAgIGVudi5CaW5hcnlOdW1iZXJzW2ldLnNldERlY2ltYWwocGFyc2VJbnQoYmluYXJ5VmFsdWUsMikpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gQ2hhbmdlQml0U2l6ZShiaXRzOiBudW1iZXIpIHtcbiAgICBkZWJvdW5jZUJpdFJlc2l6ZShiaXRzKTtcbn1cblxuZnVuY3Rpb24gY2hhbmdlQml0cyhiaXRzOiBudW1iZXIpIHtcbiAgICBiaXRzID0gTWF0aC5taW4oZW52Lk1heEJpdHMsYml0cyk7XG4gICAgYml0cyA9IE1hdGgubWF4KDIsYml0cyk7XG4gICAgbGV0IGJpdElucHV0IDogSFRNTElucHV0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYml0c1wiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgIGJpdElucHV0LnZhbHVlID0gYml0cy50b1N0cmluZygpO1xuICAgIGNvbHVtbnMgPSBiaXRzO1xuICAgIERlbGV0ZUNhbnZhcygpO1xufVxuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2MDcpO1xuIl0sIm5hbWVzIjpbImVudiIsInJvdyIsImRlY2ltYWxWYWx1ZSIsInRoaXMiLCJiaW5hcnlWYWx1ZSIsInRvU3RyaW5nIiwibmV3Qml0cyIsIk1hdGgiLCJyb3VuZCIsImxlbmd0aCIsImJpdHMiLCJjb2x1bW5zIiwiVmlzdWFsQml0cyIsIkFycmF5IiwiY3JlYXRlVmlzdWFsQml0cyIsInNldERlY2ltYWwiLCJzZXRDaXJjbGVWYWx1ZXMiLCJvdmVyZmxvdyIsImJpbmFyeSIsInN1YnN0cmluZyIsInNldENoYXJBdCIsImkiLCJzZXRPdmVyZmxvdyIsInNldEJpdCIsImNoYXJBdCIsImMiLCJhZGRWaXN1YWxCaXQiLCJjb2x1bW4iLCJWaXN1YWxCaXQiLCJzdGFydFgiLCJzcGFjaW5nIiwic3RhcnRZIiwicmFkaXVzIiwiZ2V0RGVjaW1hbCIsImdldEJpbmFyeSIsImluZGV4IiwiYm9vbCIsInNldCIsInBhcnNlSW50IiwidXBkYXRlQmluYXJ5U3RyaW5nIiwicGFkU3RhcnQiLCJzdHIiLCJjaHIiLCJCaW5hcnlOdW1iZXIiLCJlbnZpcm9ubWVudCIsImNvbnRhaW5lckRpdiIsImRvY3VtZW50IiwiYm9keSIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwiY2FudmFzIiwiY3JlYXRlRWxlbWVudCIsIkVycm9yIiwiaWQiLCJnZXRFbGVtZW50QnlJZCIsImFwcGVuZCIsImNvbnRleHQiLCJnZXRDb250ZXh0IiwiY2xhc3NBY2Nlc3NvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwibW91c2VDbGlja0V2ZW50IiwiQ29tcHV0ZSIsImJpdHNJbnB1dCIsInZhbHVlIiwiQ2hhbmdlQml0U2l6ZSIsIndpZHRoIiwiaGVpZ2h0IiwiZHJhd0xpbmUiLCJnZXRNb3VzZVBvc2l0aW9uIiwiZXZlbnQiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwic2NhbGVYIiwic2NhbGVZIiwieCIsImNsaWVudFgiLCJsZWZ0IiwieSIsImNsaWVudFkiLCJ0b3AiLCJtb3VzZVBvcyIsInJvd3MiLCJjb2wiLCJCaW5hcnlOdW1iZXJzIiwiYmVnaW5QYXRoIiwieVBvcyIsInhQb3MiLCJtb3ZlVG8iLCJsaW5lVG8iLCJzdHJva2VTdHlsZSIsInN0cm9rZSIsImNsb3NlUGF0aCIsImRyYXdCdXR0b25zIiwiQ2FudmFzU3RhZ2UiLCJjYWxsYmFjayIsIndhaXQiLCJzdGF0ZSIsInVuZGVmaW5lZCIsInByb21pc2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImNsZWFyVGltZW91dCIsInRpbWVvdXQiLCJsYXRlc3RBcmdzIiwiYXJncyIsInNldFRpbWVvdXQiLCJzIiwiRW52aXJvbm1lbnQiLCJwYWdlUGFkZGluZyIsIm1pbldpZHRoIiwib2Zmc2V0V2lkdGgiLCJvZmZzZXRIZWlnaHQiLCJNYXhCaXRzIiwiZmxvb3IiLCJtYXgiLCJtaW4iLCJ0b3RhbFdpZHRoIiwicGFkZGluZyIsInRvdGFsSGVpZ2h0IiwiY2lyY2xlcyIsInJlc3VsdHMiLCJyIiwicmlnaHQiLCJib3R0b20iLCJmaWxsQ29sb3IiLCJkcmF3Iiwic3dpdGNoQml0IiwiYml0IiwiY2xlYXJSZWN0IiwiYXJjIiwiUEkiLCJmaWxsU3R5bGUiLCJmaWxsIiwiZGVib3VuY2VXaW5kb3dSZXNpemUiLCJkZWJvdW5jZSIsIkRlbGV0ZUNhbnZhcyIsImRlYm91bmNlQml0UmVzaXplIiwiQ3JlYXRlRW52aXJvbm1lbnQiLCJyZW1vdmUiLCJzdG9yZU51bWJlcnMiLCJyZXN1bHROdW1iZXIiLCJ3aW5kb3ciLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJleHBvcnRzIiwibW9kdWxlIiwiX193ZWJwYWNrX21vZHVsZXNfXyJdLCJzb3VyY2VSb290IjoiIn0=